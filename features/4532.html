<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Feature 4532 - Code::Blocks History</title>

    <!-- Bootstrap -->
    <link rel="stylesheet" href="https://netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap-theme.min.css">

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
      <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->
  </head>
  <body role="document">
    <div class="navbar navbar-inverse" role="navigation">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="http://www.codeblocks.org/">Code::Blocks</a>
        </div>
        <div class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
            <li><a href="../index.html">Home</a></li>
            <li><a href="../bugs.html">Bugs</a></li>
            <li class="active"><a href="../features.html">Features</a></li>
            <li><a href="../patches.html">Patches</a></li>
          </ul>
        </div>
      </div>
    </div>

    <div class="container" role="main">
      <div class="row">
        <div class="col-sm-8">
          <h3>Feature #4532 <small>2009-03-16 18:43:00</small></h3>
          <h4>bozo_le_fou</h4>
          <p class="lead">Codecompletion Keyboard code Goto Impl</p>
          <p>It could be interesting to have a keyboard shortcut that allow to follow declaration or implementation of a keyword.</p>
        </div>
        <div class="col-sm-4">
          <dl class="dl-horizontal">
            <dt>Category</dt><dd>Plugins</dd>
            <dt>Status</dt><dd>Open</dd>
            <dt>Close date</dt><dd>&nbsp;</dd>
            <dt>Assigned to</dt><dd>&nbsp;</dd>
          </dl>
        </div>
      </div>
      <h4 class="page-header">History</h4>
      <div class="panel panel-default">
        <div class="panel-heading">bozo_le_fou 2009-03-16 18:45:00</div>
        <div class="panel-body">
          <pre class="pre-scrollable">I don't know how to do on this site but i made the patch for
this
------
Index: codecompletion/codecompletion.cpp
===================================================================
--- codecompletion/codecompletion.cpp	(rvision 1)
+++ codecompletion/codecompletion.cpp	(copie de travail)
@@ -120,6 +120,10 @@
 int idEditorSubMenu = wxNewId();
 int idClassMethod = wxNewId();
 int idUnimplementedClassMethods = wxNewId();
+//DeclTmp
+int idGotoImplDecl = wxNewId();
+int idComefromImplDecl = wxNewId();
+
 int idGotoDeclaration = wxNewId();
 int idGotoImplementation = wxNewId();
 int idOpenIncludeFile = wxNewId();
@@ -140,6 +144,10 @@
     EVT_MENU(idMenuGotoNextFunction,
CodeCompletion::OnGotoNextFunction)
     EVT_MENU(idClassMethod, CodeCompletion::OnClassMethod)
     EVT_MENU(idUnimplementedClassMethods,
CodeCompletion::OnUnimplementedClassMethods)
+    //DeclTmp
+    EVT_MENU(idGotoImplDecl,
CodeCompletion::OnGotoImplDeclRecursive)
+    EVT_MENU(idComefromImplDecl,
CodeCompletion::OnComefromImplDeclRecursive)
+
     EVT_MENU(idGotoDeclaration,
CodeCompletion::OnGotoDeclaration)
     EVT_MENU(idGotoImplementation,
CodeCompletion::OnGotoDeclaration)
     EVT_MENU(idOpenIncludeFile,
CodeCompletion::OnOpenIncludeFile)
@@ -263,6 +271,9 @@
         m_SearchMenu-&gt;Append(idMenuGotoFunction, _("Goto
function...\tCtrl-Alt-G"));
         m_SearchMenu-&gt;Append(idMenuGotoPrevFunction,
_("Goto previous function\tCtrl-PgUp"));
         m_SearchMenu-&gt;Append(idMenuGotoNextFunction,
_("Goto next function\tCtrl-PgDn"));
+        m_SearchMenu-&gt;Append(idGotoImplDecl, _("Goto
impl/decl...\tF6"));
+        m_SearchMenu-&gt;Append(idComefromImplDecl,
_("Comefrom decl/impl...\tShift+F6"));
+
     }
     else
         Manager::Get()-&gt;GetLogManager()-&gt;DebugLog(_T("Could
not find Search menu!"));
@@ -1007,7 +1018,7 @@
     m_InitDone = true;
 
 	// Dreaded DDE-open bug related: do not touch the
following lines unless for a good reason
-    
+
     // parse any projects opened through DDE or the
command-line
     ParseActiveProjects();
     ProjectManager* prjMan =
Manager::Get()-&gt;GetProjectManager();
@@ -1595,6 +1606,63 @@
     DoAllMethodsImpl();
 }
 
+void
CodeCompletion::OnGotoImplDeclRecursive(wxCommandEvent&amp; event)
+{
+
+  cbEditor* ed =
Manager::Get()-&gt;GetEditorManager()-&gt;GetBuiltinActiveEditor();
+  cbStyledTextCtrl* control = ed-&gt;GetControl();
+
+  int pos = control-&gt;GetCurrentPos();
+  int ws = control-&gt;WordStartPosition(pos, true);
+  int we = control-&gt;WordEndPosition(pos, true);
+  wxString txt = control-&gt;GetTextRange(ws, we);
+  m_LastKeyword=txt;
+  m_listLastKeyword.push_back(txt);
+
+  FunctionScope fs;
+  fs.Name=txt;
+  fs.StartLine=ed-&gt;GetControl()-&gt;GetCurrentLine();
+  fs.Scope=ed-&gt;GetFilename();
+  m_listLastPositions.push_back(fs);
+
+
+  if (m_listLastPositions.size()&gt;=2)
+  {
+    FunctionsScopeVec::reverse_iterator rii;
+    rii=m_listLastPositions.rbegin();
+    rii++;
+    if(fs.Name==(rii-&gt;Name))
+    {
+      event.SetId(idGotoDeclaration);
+
+      if ((m_listLastPositions.size()&gt;2))
+      {
+        ++rii;
+        if ((rii)-&gt;Name == (m_listLastPositions.back().Name))
+          m_listLastPositions.pop_back();
+      }
+    }
+  }
+
+  OnGotoDeclaration(event);
+}
+
+void
CodeCompletion::OnComefromImplDeclRecursive(wxCommandEvent&amp;
event)
+{
+
+
+  if (m_listLastPositions.size()&gt;0)
+  {
+
+    FunctionScope fs=m_listLastPositions.back();
+    EditorManager* edMan = Manager::Get()-&gt;GetEditorManager();
+    cbEditor* ed =edMan-&gt;Open(fs.Scope);
+    ed-&gt;GotoLine(fs.StartLine);
+
+    m_listLastPositions.pop_back();
+  }
+
+}
 void CodeCompletion::OnGotoDeclaration(wxCommandEvent&amp; event)
 {
     EditorManager* edMan = Manager::Get()-&gt;GetEditorManager();
@@ -1632,7 +1700,9 @@
             {
                 // only match tokens that have filename info
                 if ((event.GetId() == idGotoImplementation
&amp;&amp; !sel-&gt;GetImplFilename().IsEmpty()) ||
-                    (event.GetId() == idGotoDeclaration &amp;&amp;
!sel-&gt;GetFilename().IsEmpty()))
+                    (event.GetId() == idGotoDeclaration &amp;&amp;
!sel-&gt;GetFilename().IsEmpty()) ||
+                    (event.GetId() == idGotoImplDecl &amp;&amp;
!sel-&gt;GetImplFilename().IsEmpty()) ||
+                    (event.GetId() == idComefromImplDecl &amp;&amp;
!sel-&gt;GetImplFilename().IsEmpty()))
                 {
                     selections.Add(sel-&gt;DisplayName());
                     int_selections.Add(*it);
@@ -1656,13 +1726,33 @@
     // do we have a token?
     if (token)
     {
-        if(event.GetId() == idGotoImplementation)
+        if(event.GetId() == idGotoImplementation ||
event.GetId() == idGotoImplDecl || event.GetId() ==
idComefromImplDecl)
         {
             cbEditor* ed =
edMan-&gt;Open(token-&gt;GetImplFilename());
             if (ed)
+            {
                 ed-&gt;GotoLine(token-&gt;m_ImplLine - 1);
+
+            }
+            else if (event.GetId() == idGotoImplDecl ||
event.GetId() == idComefromImplDecl)
+            {
+              ed = edMan-&gt;Open(token-&gt;GetFilename());
+              if (ed)
+              {
+                ed-&gt;GotoLine(token-&gt;m_Line - 1);
+
+              }
+              else
+              {
+               
cbMessageBox(wxString::Format(_("Impl/Declaration not found:
%s"), txt.c_str()), _("Warning"), wxICON_WARNING);
+              }
+            }
             else
-               
cbMessageBox(wxString::Format(_("Implementation not found:
%s"), txt.c_str()), _("Warning"), wxICON_WARNING);
+            {
+            //If no Implementation Goto Declaration
+             
cbMessageBox(wxString::Format(_("Implementation not found:
%s"), txt.c_str()), _("Warning"), wxICON_WARNING);
+
+            }
         }
         else
         {
Index: codecompletion/codecompletion.h
===================================================================
--- codecompletion/codecompletion.h	(rvision 1)
+++ codecompletion/codecompletion.h	(copie de travail)
@@ -40,9 +40,11 @@
 		wxString Name;
 	};
 
+
 	typedef std::vector&lt;FunctionScope&gt; FunctionsScopeVec;
 	typedef std::vector&lt;NameSpace&gt; NameSpaceVec;
 
+
 	struct FunctionsScopePerFile
 	{
 		FunctionsScopeVec m_FunctionsScope;
@@ -87,6 +89,10 @@
         void OnGotoNextFunction(wxCommandEvent&amp; event);
         void OnClassMethod(wxCommandEvent&amp; event);
         void OnUnimplementedClassMethods(wxCommandEvent&amp;
event);
+        //DeclTmp
+        void OnGotoImplDeclRecursive(wxCommandEvent&amp; event);
+        void OnComefromImplDeclRecursive(wxCommandEvent&amp;
event);
+
         void OnGotoDeclaration(wxCommandEvent&amp; event);
         void OnOpenIncludeFile(wxCommandEvent&amp; event);
         void OnAppDoneStartup(CodeBlocksEvent&amp; event);
@@ -121,6 +127,8 @@
         wxString m_LastIncludeFileFrom;
         wxString m_LastIncludeFile;
         wxString m_LastKeyword;
+        list&lt;wxString&gt; m_listLastKeyword;
+        FunctionsScopeVec m_listLastPositions;
 
         wxMenu* m_EditMenu;
         wxMenu* m_SearchMenu;
@@ -148,7 +156,7 @@
         wxString m_LastFile;
 
         wxTimer m_FunctionsParsingTimer;
-        
+
         bool m_LexerKeywordsToInclude[9];
 
         DECLARE_EVENT_TABLE()
</pre>
        </div>
      </div>
      <div class="panel panel-default">
        <div class="panel-heading">ollydbg 2009-06-09 16:16:00</div>
        <div class="panel-body">
          <p>Do you mean that you want to add a short-cut key to "Goto impl" instead of the context menu?</p>
          <p>You can open a thread in the CB's forum,  so that people can discuss this issue.</p>
        </div>
      </div>
    </div>

    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
    <!-- Include all compiled plugins (below), or include individual files as needed -->
    <script src="https://netdna.bootstrapcdn.com/bootstrap/3.1.1/js/bootstrap.min.js"></script>
  </body>
</html>
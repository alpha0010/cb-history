<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Patch 1908 - Code::Blocks History</title>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap-theme.min.css">
    <link rel="stylesheet" href="../pygments.css">
  </head>
  <body role="document">
    <div class="navbar navbar-inverse" role="navigation">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="http://www.codeblocks.org/">Code::Blocks</a>
        </div>
        <div class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
            <li><a href="../index.html">Home</a></li>
            <li><a href="../bugs.html">Bugs</a></li>
            <li><a href="../features.html">Features</a></li>
            <li class="active"><a href="../patches.html">Patches</a></li>
          </ul>
        </div>
      </div>
    </div>

    <div class="container" role="main">
      <div class="row">
        <div class="col-sm-8">
          <h3>Patch #1908 <small>2007-03-01 00:36</small></h3>
          <h4>stahta01</h4>
          Patch SDK files for wxW28 with disable_compat26
          <dl class="dl-horizontal">
            <dt>Download</dt>
            <dd><a href="1908-Patch_SDK_file.patch">1908-Patch_SDK_file.patch</a> (4.0 KB)</dd>
          </dl>
        </div>
        <div class="col-sm-4">
          <dl class="dl-horizontal">
            <dt>Category</dt><dd>Application::Refinement</dd>
            <dt>Status</dt><dd>Closed</dd>
            <dt>Close date</dt><dd>2007-06-09 04:57 <a href="http://cb.biplab.in/websvn/log.php?sr=4079"><span class="glyphicon glyphicon-link"></span></a></dd>
            <dt>Assigned to</dt><dd>&nbsp;</dd>
          </dl>
        </div>
      </div>
      <div class="highlight"><pre class="pre-scrollable"><span class="gh">Index: src/sdk/wxFlatNotebook/src/wxFlatNotebook/wxFlatNotebook.cpp</span>
<span class="gh">===================================================================</span>
<span class="gd">--- src/sdk/wxFlatNotebook/src/wxFlatNotebook/wxFlatNotebook.cpp    (revision 4032)</span>
<span class="gi">+++ src/sdk/wxFlatNotebook/src/wxFlatNotebook/wxFlatNotebook.cpp    (working copy)</span>
<span class="gu">@@ -1017,7 +1017,11 @@</span>
     }
 
     rect = wxRect(btnXPos, 8, 16, 16);
<span class="gi">+#if wxCHECK_VERSION(2, 8, 0)</span>
<span class="gi">+    if(rect.Contains(pt))</span>
<span class="gi">+#else</span>
     if(rect.Inside(pt))
<span class="gi">+#endif</span>
     {
         return (style &amp; wxFNB_NO_X_BUTTON) ? wxFNB_NOWHERE : wxFNB_X;
     }
<span class="gu">@@ -1026,18 +1030,30 @@</span>
     if( style &amp; wxFNB_DROPDOWN_TABS_LIST )
     {
         rect = wxRect(render-&gt;GetDropArrowButtonPos( this ), 8, 16, 16);
<span class="gi">+#if wxCHECK_VERSION(2, 8, 0)</span>
<span class="gi">+        if( rect.Contains(pt) )</span>
<span class="gi">+#else</span>
         if( rect.Inside(pt) )
<span class="gi">+#endif</span>
             return wxFNB_DROP_DOWN_ARROW;
     }
 
<span class="gi">+#if wxCHECK_VERSION(2, 8, 0)</span>
<span class="gi">+    if(rect.Contains(pt))</span>
<span class="gi">+#else</span>
     if(rect.Inside(pt))
<span class="gi">+#endif</span>
     {
         return (style &amp; wxFNB_NO_NAV_BUTTONS) ? wxFNB_NOWHERE : wxFNB_RIGHT_ARROW;
     }
 
 
     rect = wxRect(btnLeftPos, 8, 16, 16);
<span class="gi">+#if wxCHECK_VERSION(2, 8, 0)</span>
<span class="gi">+    if(rect.Contains(pt))</span>
<span class="gi">+#else</span>
     if(rect.Inside(pt))
<span class="gi">+#endif</span>
     {
         return (style &amp; wxFNB_NO_NAV_BUTTONS) ? wxFNB_NOWHERE : wxFNB_LEFT_ARROW;
     }
<span class="gu">@@ -1054,7 +1070,11 @@</span>
         if(style &amp; wxFNB_X_ON_TAB &amp;&amp; (int)cur == GetSelection())
         {
             // &#39;x&#39; button exists on a tab
<span class="gi">+#if wxCHECK_VERSION(2, 8, 0)</span>
<span class="gi">+            if(m_pagesInfoVec[cur].GetXRect().Contains(pt))</span>
<span class="gi">+#else</span>
             if(m_pagesInfoVec[cur].GetXRect().Inside(pt))
<span class="gi">+#endif</span>
             {
                 pageInfo = pgInfo;
                 tabIdx = (int)cur;
<span class="gu">@@ -1082,7 +1102,11 @@</span>
 
             wxRect tabRect = wxRect(pgInfo.GetPosition().x, pgInfo.GetPosition().y, 
                 pgInfo.GetSize().x, pgInfo.GetSize().y);
<span class="gi">+#if wxCHECK_VERSION(2, 8, 0)</span>
<span class="gi">+            if(tabRect.Contains(pt))</span>
<span class="gi">+#else</span>
             if(tabRect.Inside(pt))
<span class="gi">+#endif</span>
             {
                 // We have a match
                 pageInfo = pgInfo;
<span class="gh">Index: src/sdk/wxscintilla/src/PlatWX.cpp</span>
<span class="gh">===================================================================</span>
<span class="gd">--- src/sdk/wxscintilla/src/PlatWX.cpp    (revision 4032)</span>
<span class="gi">+++ src/sdk/wxscintilla/src/PlatWX.cpp    (working copy)</span>
<span class="gu">@@ -1382,11 +1382,28 @@</span>
 //----------------------------------------------------------------------
 
 ElapsedTime::ElapsedTime() {
<span class="gi">+#if !wxCHECK_VERSION(2, 6, 2)</span>
     wxStartTimer();
<span class="gi">+#else</span>
<span class="gi">+    wxLongLong localTime = wxGetLocalTimeMillis();</span>
<span class="gi">+    littleBit = localTime.GetLo();</span>
<span class="gi">+    bigBit = localTime.GetHi();</span>
<span class="gi">+#endif</span>
 }
 
 double ElapsedTime::Duration(bool reset) {
<span class="gi">+#if !wxCHECK_VERSION(2, 6, 2)</span>
     double result = wxGetElapsedTime(reset);
<span class="gi">+#else</span>
<span class="gi">+    wxLongLong prevTime(bigBit, littleBit);</span>
<span class="gi">+    wxLongLong localTime = wxGetLocalTimeMillis();</span>
<span class="gi">+    if(reset) {</span>
<span class="gi">+        littleBit = localTime.GetLo();</span>
<span class="gi">+        bigBit = localTime.GetHi();</span>
<span class="gi">+    }</span>
<span class="gi">+    wxLongLong duration = localTime - prevTime;</span>
<span class="gi">+    double result = duration.ToDouble();</span>
<span class="gi">+#endif</span>
     result /= 1000.0;
     return result;
 }
<span class="gh">Index: src/sdk/wxscintilla/src/ScintillaWX.cpp</span>
<span class="gh">===================================================================</span>
<span class="gd">--- src/sdk/wxscintilla/src/ScintillaWX.cpp    (revision 4032)</span>
<span class="gi">+++ src/sdk/wxscintilla/src/ScintillaWX.cpp    (working copy)</span>
<span class="gu">@@ -684,7 +684,6 @@</span>
     PRectangle rcClient = GetClientRectangle();
     paintingAllText = rcPaint.Contains(rcClient);
 
<span class="gd">-    dc-&gt;BeginDrawing();</span>
     ClipChildren(*dc, rcPaint);
     Paint(surfaceWindow, rcPaint);
 
<span class="gu">@@ -695,7 +694,6 @@</span>
         FullPaint();
     }
     paintState = notPainting;
<span class="gd">-    dc-&gt;EndDrawing();</span>
 }
 
 
<span class="gh">Index: src/include/globals.h</span>
<span class="gh">===================================================================</span>
<span class="gd">--- src/include/globals.h    (revision 4032)</span>
<span class="gi">+++ src/include/globals.h    (working copy)</span>
<span class="gu">@@ -309,4 +309,15 @@</span>
     extern DLLIMPORT windows_version_t WindowsVersion();
 };
 
<span class="gi">+#if wxCHECK_VERSION(2, 8, 0) &amp;&amp; !(WXWIN_COMPATIBILITY_2_6)</span>
<span class="gi">+    // Note the following defines need removed</span>
<span class="gi">+    // when CodeBlocks support for wxWidgets 2.6 is dropped</span>
<span class="gi">+    #define wxOPEN wxFD_OPEN</span>
<span class="gi">+    #define wxFILE_MUST_EXIST wxFD_FILE_MUST_EXIST</span>
<span class="gi">+    #define wxMULTIPLE wxFD_MULTIPLE</span>
<span class="gi">+    #define wxSAVE wxFD_SAVE</span>
<span class="gi">+    #define wxOVERWRITE_PROMPT wxFD_OVERWRITE_PROMPT</span>
<span class="gi">+    #define wxCHANGE_DIR wxFD_CHANGE_DIR</span>
<span class="gi">+#endif</span>
<span class="gi">+</span>
 #endif // SDK_GLOBALS_H
</pre></div>

      <h4 class="page-header">History</h4>
      <div class="panel panel-default">
        <div class="panel-heading">stahta01 2007-03-01 00:37</div>
        <div class="panel-body">
          <p>Filename: disable_compat26_sdk-unix.patch</p>
          <p>Purpose: Change CB SDK files to improve support for wxWidgets 2.8 with option disable_compat26.</p>
          <p>Reference: wx/platinfo.h</p>
          <p>Problem 1: Operating Systems Constants where renamed with wxOS_ prefix</p>
          <p>Solution 1: Use new names in #if/else/endif blocks</p>
          <p>Note 1: 2.6 value is wxWINDOWS_NT and 2.8 value is wxOS_WINDOWS_NT</p>
          <p>Problem 2: Depreciated methods BeginDrawing and EndDrawing removed.</p>
          <p>Reference: wx/dc.h</p>
          <p>Solution 2: Removed Depreciated methods.</p>
          <p>Problem 3: Contructor signature for class wxFontDialog has been changed.</p>
          <p>Reference: wx/fontdlg.h</p>
          <p>Solution 3: Use new signature in #if/else/endif block</p>
          <p>Problem 4: Depreciated method wxRect::Inside replaced by wxRect::Contains.</p>
          <p>Reference: wx/gdicmn.h</p>
          <p>Solution 4: Replace method Inside with Contains</p>
          <p>Problem 5: Depreciated methods wxStartTimer and wxGetElapsedTime</p>
          <p>Reference: wx/stopwatch.h</p>
          <p>Solution 5: Rewrote code to use method wxGetLocalTimeMillis.</p>
          <p>Problem 6: File Constants where renamed with wxFD_ prefix</p>
          <p>Reference: wx/filedlg.h</p>
          <p>Solution 6: Added code to src/include/globals.h to define old constanst.</p>
          <p>#if wxCHECK_VERSION(2, 8, 0) &amp;&amp; !(WXWIN_COMPATIBILITY_2_6)</p>
          <p>// Note the following defines need removed</p>
          <p>// when CodeBlocks support for wxWidgets 2.6 is dropped</p>
          <p>#define wxOPEN wxFD_OPEN</p>
          <p>#define wxFILE_MUST_EXIST wxFD_FILE_MUST_EXIST</p>
          <p>#define wxMULTIPLE wxFD_MULTIPLE</p>
          <p>#define wxSAVE wxFD_SAVE</p>
          <p>#define wxOVERWRITE_PROMPT wxFD_OVERWRITE_PROMPT</p>
          <p>#define wxCHANGE_DIR wxFD_CHANGE_DIR</p>
          <p>#endif</p>
        </div>
      </div>
      <div class="panel panel-default">
        <div class="panel-heading">stahta01 2007-03-30 18:39</div>
        <div class="panel-body">
          <p>Updated to match current SVN 3797</p>
          <p>Tim S</p>
        </div>
      </div>
      <div class="panel panel-default">
        <div class="panel-heading">stahta01 2007-06-01 13:10</div>
        <div class="panel-body">
          <p>Updated to SVN 4032</p>
        </div>
      </div>
      <div class="panel panel-default">
        <div class="panel-heading">stahta01 2007-06-09 04:48</div>
        <div class="panel-body">
          <p>Please close, all of this has been fixed to my knowledge except for the File Dialog stuff which I posted a new patch of <a href="2043.html" data-toggle="tooltip" title="Patch CB Core files for wxW28 with disable_compat26">https://developer.berlios.de/patch/?func=detailpatch&amp;patch_id=2043&amp;group_id=5358</a></p>
          <p>Tim S</p>
        </div>
      </div>
      <div class="panel panel-default">
        <div class="panel-heading">biplab 2007-06-09 04:57</div>
        <div class="panel-body">
          <p>Closed.</p>
        </div>
      </div>
    </div>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.0/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>
    <script>
      $(document).ready(function() {
        $("body").tooltip({ selector: '[data-toggle=tooltip]' });
      });
    </script>
  </body>
</html>

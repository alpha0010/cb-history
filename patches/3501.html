<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Patch 3501 - Code::Blocks History</title>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap-theme.min.css">
    <link rel="stylesheet" href="../pygments.css">
  </head>
  <body role="document">
    <div class="navbar navbar-inverse" role="navigation">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="http://www.codeblocks.org/">Code::Blocks</a>
        </div>
        <div class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
            <li><a href="../index.html">Home</a></li>
            <li><a href="../bugs.html">Bugs</a></li>
            <li><a href="../features.html">Features</a></li>
            <li class="active"><a href="../patches.html">Patches</a></li>
          </ul>
        </div>
      </div>
    </div>

    <div class="container" role="main">
      <div class="row">
        <div class="col-sm-8">
          <h3>Patch #3501 <small>2013-09-29 20:18</small></h3>
          <h4>mojca</h4>
          wxcontrib: patches for wx 2.9
          <dl class="dl-horizontal">
            <dt>Download</dt>
            <dd><a href="3501-wxcontrib_patc.patch">3501-wxcontrib_patc.patch</a> (814 bytes)</dd>
          </dl>
        </div>
        <div class="col-sm-4">
          <dl class="dl-horizontal">
            <dt>Category</dt><dd>Plugin::Bugfix</dd>
            <dt>Status</dt><dd>Accepted</dd>
            <dt>Close date</dt><dd>2013-10-04 21:24 <a href="http://cb.biplab.in/websvn/log.php?sr=9380"><span class="glyphicon glyphicon-link"></span></a></dd>
            <dt>Assigned to</dt><dd>tpetrov</dd>
          </dl>
        </div>
      </div>
      <div class="highlight"><pre class="pre-scrollable"><span class="gh">Index: src/plugins/contrib/wxContribItems/wxTreeList/src/treelistctrl.cpp</span>
<span class="gh">===================================================================</span>
<span class="gd">--- src/plugins/contrib/wxContribItems/wxTreeList/src/treelistctrl.cpp    (revision 9378)</span>
<span class="gi">+++ src/plugins/contrib/wxContribItems/wxTreeList/src/treelistctrl.cpp    (working copy)</span>
<span class="gu">@@ -2021,14 +2021,8 @@</span>
                                    const wxString&amp; name) {
 
 #ifdef __WXMAC__
<span class="gd">-    if (style &amp; wxTR_HAS_BUTTONS) style |= wxTR_MAC_BUTTONS;</span>
<span class="gd">-    if (style &amp; wxTR_HAS_BUTTONS) style &amp;= ~wxTR_HAS_BUTTONS;</span>
     style &amp;= ~wxTR_LINES_AT_ROOT;
     style |= wxTR_NO_LINES;
<span class="gd">-</span>
<span class="gd">-    int major,minor;</span>
<span class="gd">-    wxGetOsVersion( &amp;major, &amp;minor );</span>
<span class="gd">-    if (major &lt; 10) style |= wxTR_ROW_LINES;</span>
 #endif
 
     wxScrolledWindow::Create (parent, id, pos, size, style|wxHSCROLL|wxVSCROLL, name);
</pre></div>

      <h4 class="page-header">History</h4>
      <div class="panel panel-default">
        <div class="panel-heading">mojca 2013-09-29 20:22</div>
        <div class="panel-body">
          <p>I'm submitting a patch for plugins/contrib/wxContribItems. It contains four chunks of code. The first three are absolutely needed to work with wxWidgets 2.9 and are safe for earlier versions. The fourth one was needed to compile on 2.9, but I'm not sure what it purpose was on earlier versions or how it was user.</p>
          <p>The wxWidgets sources (include/wx/treebase.h) say they the constants are deprecated:</p>
          <p>#if WXWIN_COMPATIBILITY_2_6</p>
          <p>// deprecated, don't use</p>
          <p>#define wxTR_MAC_BUTTONS 0</p>
          <p>#define wxTR_AQUA_BUTTONS 0</p>
          <p>#endif // WXWIN_COMPATIBILITY_2_6</p>
        </div>
      </div>
      <div class="panel panel-default">
        <div class="panel-heading">mojca 2013-09-29 21:18</div>
        <div class="panel-body">
          <p>I now see that the first two chunks have already been fixed. So only the last two are still needed to be applied.</p>
        </div>
      </div>
      <div class="panel panel-default">
        <div class="panel-heading">mojca 2013-10-01 21:27</div>
        <div class="panel-body">
          <p>This patch has already been dealt with (the first three chunks were applied) except for this:</p>
          <p>-    if (style &amp; wxTR_HAS_BUTTONS) style |= wxTR_MAC_BUTTONS;</p>
          <p>-    if (style &amp; wxTR_HAS_BUTTONS) style &amp;= ~wxTR_HAS_BUTTONS;</p>
          <p>and I'm not sure what to do with that.</p>
        </div>
      </div>
      <div class="panel panel-default">
        <div class="panel-heading">mojca 2013-10-02 10:40</div>
        <div class="panel-body">
          <pre class="pre-scrollable">From wxWidgets 2.8:

#if WXWIN_COMPATIBILITY_2_6
// deprecated, don't use
#define wxTR_MAC_BUTTONS             0
#define wxTR_AQUA_BUTTONS            0
#endif // WXWIN_COMPATIBILITY_2_6

I think it really makes sense to delete at least these two lines. I'm not sure if anyone still cares about ancient macs running wxWidgets 2.6 (when the code doesn't even compile on the latest ones ;).

--- src/plugins/contrib/wxContribItems/wxTreeList/src/treelistctrl.cpp	(revision 9378)
+++ src/plugins/contrib/wxContribItems/wxTreeList/src/treelistctrl.cpp	(working copy)
@@ -2021,8 +2021,6 @@
                                    const wxString&amp; name) {

 #ifdef __WXMAC__
-    if (style &amp; wxTR_HAS_BUTTONS) style |= wxTR_MAC_BUTTONS;
-    if (style &amp; wxTR_HAS_BUTTONS) style &amp;= ~wxTR_HAS_BUTTONS;
     style &amp;= ~wxTR_LINES_AT_ROOT;
     style |= wxTR_NO_LINES;

On the other hand the lines that follow are even more outdated, targetting Mac OS 8/9, so I believe they could go just as well:

    int major,minor;
    wxGetOsVersion( &amp;major, &amp;minor );
    if (major &lt; 10) style |= wxTR_ROW_LINES;

</pre>
        </div>
      </div>
      <div class="panel panel-default">
        <div class="panel-heading">mojca 2013-10-02 20:48</div>
        <div class="panel-body">
          <p>I uploaded a new patch. It deletes 5 lines.</p>
          <p>Deleting the first two lines is necessary in order to be prevent a compile error.</p>
          <p>The last three lines are harmless and only affect Mac OS &lt; 10.0, but I think that supporting that would be an equivalent of supporting Windows 3.11. (wxWidgets 2.9 don't even support 10.4 any longer, let alone versions before), so I consider it safe to remove them.</p>
        </div>
      </div>
    </div>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.0/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>
  </body>
</html>

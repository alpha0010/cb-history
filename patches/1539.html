<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Patch 1539 - Code::Blocks History</title>

    <!-- Bootstrap -->
    <link rel="stylesheet" href="https://netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap-theme.min.css">

    <link rel="stylesheet" href="../pygments.css">

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
      <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->
  </head>
  <body role="document">
    <div class="navbar navbar-inverse" role="navigation">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="http://www.codeblocks.org/">Code::Blocks</a>
        </div>
        <div class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
            <li><a href="../index.html">Home</a></li>
            <li><a href="../bugs.html">Bugs</a></li>
            <li><a href="../features.html">Features</a></li>
            <li class="active"><a href="../patches.html">Patches</a></li>
          </ul>
        </div>
      </div>
    </div>

    <div class="container" role="main">
      <div class="row">
        <div class="col-sm-8">
          <h3>Patch #1539 <small>2006-10-08 14:18:31</small></h3>
          <h4>jthedering</h4>
          Wrong XRCCTRL usage assert failure fixes
          <dl class="dl-horizontal">
            <dt>Download</dt>
            <dd><a href="1539-Wrong_XRCCTRL.patch">1539-Wrong_XRCCTRL.patch</a></dd>
          </dl>
        </div>
        <div class="col-sm-4">
          <dl class="dl-horizontal">
            <dt>Category</dt><dd>Application::Bugfix</dd>
            <dt>Status</dt><dd>Out of date</dd>
            <dt>Close date</dt><dd>2007-04-12 12:44:18</dd>
            <dt>Assigned to</dt><dd>&nbsp;</dd>
          </dl>
        </div>
      </div>
      <div class="highlight"><pre class="pre-scrollable"><span class="gh">Index: src/include/globals.h</span>
<span class="gh">===================================================================</span>
<span class="gd">--- src/include/globals.h    (Revision 3882)</span>
<span class="gi">+++ src/include/globals.h    (Arbeitskopie)</span>
<span class="gu">@@ -309,4 +309,15 @@</span>
     extern DLLIMPORT windows_version_t WindowsVersion();
 };
 
<span class="gi">+#ifdef __WXDEBUG__</span>
<span class="gi">+//This is equivalent to XRCCTRL, but doesn&#39;t cause an assert failure</span>
<span class="gi">+//if the control doesn&#39;t exist, so use it instead of XRCCTRL</span>
<span class="gi">+//if you check the existence yourself</span>
<span class="gi">+#define XRCCTRL_OR_NULL(window, id, type) \</span>
<span class="gi">+    (wxDynamicCast((window).FindWindow(XRCID(id)), type))</span>
<span class="gi">+#else</span>
<span class="gi">+#define XRCCTRL_OR_NULL(window, id, type) \</span>
<span class="gi">+    XRCCTRL(window, id, type)</span>
<span class="gi">+#endif // __WXDEBUG__</span>
<span class="gi">+</span>
 #endif // SDK_GLOBALS_H
<span class="gh">Index: src/plugins/compilergcc/compileroptionsdlg.cpp</span>
<span class="gh">===================================================================</span>
<span class="gd">--- src/plugins/compilergcc/compileroptionsdlg.cpp    (Revision 3882)</span>
<span class="gi">+++ src/plugins/compilergcc/compileroptionsdlg.cpp    (Arbeitskopie)</span>
<span class="gu">@@ -230,7 +230,7 @@</span>
         XRCCTRL(*this, &quot;lblBuildScriptsNote&quot;, wxStaticText)-&gt;Show(hasBuildScripts);
     }
 
<span class="gd">-    wxChoice* cmb = XRCCTRL(*this, &quot;cmbBuildMethod&quot;, wxChoice);</span>
<span class="gi">+    wxChoice* cmb = XRCCTRL_OR_NULL(*this, &quot;cmbBuildMethod&quot;, wxChoice);</span>
     if (cmb)
     {
         // build method is always &quot;direct&quot; now
<span class="gu">@@ -441,7 +441,7 @@</span>
 
 void CompilerOptionsDlg::DoFillVars()
 {
<span class="gd">-    wxListBox* lst = XRCCTRL(*this, &quot;lstVars&quot;, wxListBox);</span>
<span class="gi">+    wxListBox* lst = XRCCTRL_OR_NULL(*this, &quot;lstVars&quot;, wxListBox);</span>
     if (!lst)
         return;
     lst-&gt;Clear();
<span class="gu">@@ -462,38 +462,38 @@</span>
 
 void CompilerOptionsDlg::DoFillOthers()
 {
<span class="gd">-    wxCheckBox* chk = XRCCTRL(*this, &quot;chkIncludeFileCwd&quot;, wxCheckBox);</span>
<span class="gi">+    wxCheckBox* chk = XRCCTRL_OR_NULL(*this, &quot;chkIncludeFileCwd&quot;, wxCheckBox);</span>
     if (chk)
         chk-&gt;SetValue(Manager::Get()-&gt;GetConfigManager(_T(&quot;compiler&quot;))-&gt;ReadBool(_T(&quot;/include_file_cwd&quot;), false));
 
<span class="gd">-    chk = XRCCTRL(*this, &quot;chkIncludePrjCwd&quot;, wxCheckBox);</span>
<span class="gi">+    chk = XRCCTRL_OR_NULL(*this, &quot;chkIncludePrjCwd&quot;, wxCheckBox);</span>
     if (chk)
         chk-&gt;SetValue(Manager::Get()-&gt;GetConfigManager(_T(&quot;compiler&quot;))-&gt;ReadBool(_T(&quot;/include_prj_cwd&quot;), false));
 
<span class="gd">-    chk = XRCCTRL(*this, &quot;chkSaveHtmlLog&quot;, wxCheckBox);</span>
<span class="gi">+    chk = XRCCTRL_OR_NULL(*this, &quot;chkSaveHtmlLog&quot;, wxCheckBox);</span>
     if (chk)
         chk-&gt;SetValue(Manager::Get()-&gt;GetConfigManager(_T(&quot;compiler&quot;))-&gt;ReadBool(_T(&quot;/save_html_build_log&quot;), false));
 
<span class="gd">-    chk = XRCCTRL(*this, &quot;chkFullHtmlLog&quot;, wxCheckBox);</span>
<span class="gi">+    chk = XRCCTRL_OR_NULL(*this, &quot;chkFullHtmlLog&quot;, wxCheckBox);</span>
     if (chk)
         chk-&gt;SetValue(Manager::Get()-&gt;GetConfigManager(_T(&quot;compiler&quot;))-&gt;ReadBool(_T(&quot;/save_html_build_log/full_command_line&quot;), false));
 
<span class="gd">-    chk = XRCCTRL(*this, &quot;chkBuildProgressBar&quot;, wxCheckBox);</span>
<span class="gi">+    chk = XRCCTRL_OR_NULL(*this, &quot;chkBuildProgressBar&quot;, wxCheckBox);</span>
     if (chk)
         chk-&gt;SetValue(Manager::Get()-&gt;GetConfigManager(_T(&quot;compiler&quot;))-&gt;ReadBool(_T(&quot;/build_progress/bar&quot;), false));
 
<span class="gd">-    chk = XRCCTRL(*this, &quot;chkBuildProgressPerc&quot;, wxCheckBox);</span>
<span class="gi">+    chk = XRCCTRL_OR_NULL(*this, &quot;chkBuildProgressPerc&quot;, wxCheckBox);</span>
     if (chk)
         chk-&gt;SetValue(Manager::Get()-&gt;GetConfigManager(_T(&quot;compiler&quot;))-&gt;ReadBool(_T(&quot;/build_progress/percentage&quot;), false));
 
<span class="gd">-    wxSpinCtrl* spn = XRCCTRL(*this, &quot;spnParallelProcesses&quot;, wxSpinCtrl);</span>
<span class="gi">+    wxSpinCtrl* spn = XRCCTRL_OR_NULL(*this, &quot;spnParallelProcesses&quot;, wxSpinCtrl);</span>
     if (spn)
     {
         spn-&gt;SetRange(1, 16);
         spn-&gt;SetValue(Manager::Get()-&gt;GetConfigManager(_T(&quot;compiler&quot;))-&gt;ReadInt(_T(&quot;/parallel_processes&quot;), 1));
     }
 
<span class="gd">-    spn = XRCCTRL(*this, &quot;spnMaxErrors&quot;, wxSpinCtrl);</span>
<span class="gi">+    spn = XRCCTRL_OR_NULL(*this, &quot;spnMaxErrors&quot;, wxSpinCtrl);</span>
     if (spn)
     {
         spn-&gt;SetRange(0, 1000);
<span class="gu">@@ -737,7 +737,7 @@</span>
         m_LinkerOptions = compiler-&gt;GetLinkerOptions();
         m_LinkLibs = compiler-&gt;GetLinkLibs();
 
<span class="gd">-        wxChoice* cmb = XRCCTRL(*this, &quot;cmbLogging&quot;, wxChoice);</span>
<span class="gi">+        wxChoice* cmb = XRCCTRL_OR_NULL(*this, &quot;cmbLogging&quot;, wxChoice);</span>
         if (cmb)
             cmb-&gt;SetSelection((int)compiler-&gt;GetSwitches().logging);
     }
<span class="gu">@@ -797,7 +797,7 @@</span>
     ArrayString2TextCtrl(m_LinkerOptions, XRCCTRL(*this, &quot;txtLinkerOptions&quot;, wxTextCtrl));
 
     // only if &quot;Commands&quot; page exists
<span class="gd">-    if (XRCCTRL(*this, &quot;txtCmdBefore&quot;, wxTextCtrl))</span>
<span class="gi">+    if (XRCCTRL_OR_NULL(*this, &quot;txtCmdBefore&quot;, wxTextCtrl))</span>
     {
         ArrayString2TextCtrl(CommandsBeforeBuild, XRCCTRL(*this, &quot;txtCmdBefore&quot;, wxTextCtrl));
         ArrayString2TextCtrl(CommandsAfterBuild, XRCCTRL(*this, &quot;txtCmdAfter&quot;, wxTextCtrl));
<span class="gu">@@ -885,7 +885,7 @@</span>
         compiler-&gt;SetLinkerOptions(m_LinkerOptions);
         compiler-&gt;SetLinkLibs(m_LinkLibs);
 
<span class="gd">-        wxChoice* cmb = XRCCTRL(*this, &quot;cmbLogging&quot;, wxChoice);</span>
<span class="gi">+        wxChoice* cmb = XRCCTRL_OR_NULL(*this, &quot;cmbLogging&quot;, wxChoice);</span>
         if (cmb)
         {
             CompilerSwitches switches = compiler-&gt;GetSwitches();
<span class="gu">@@ -899,7 +899,7 @@</span>
         wxArrayString CommandsBeforeBuild;
         wxArrayString CommandsAfterBuild;
<em><strong>file truncated...</strong></em>
</pre></div>

      <h4 class="page-header">History</h4>
      <div class="panel panel-default">
        <div class="panel-heading">jthedering 2006-10-08 14:23:10</div>
        <div class="panel-body">
          <p>XRCCTRL contains the contract that the referenced control should exist. When it is used to check if a control exists, like this</p>
          <p>if(XRCCTRL(*this,"button",wxButton))</p>
          <p>it will cause an assert failure in debug mode. Therefore I added a second form of XRCCTRL called XRCCTRL_MAYBE (please change the name if you wish) that can be used in those cases.</p>
        </div>
      </div>
      <div class="panel panel-default">
        <div class="panel-heading">mandrav 2007-04-12 12:44:18</div>
        <div class="panel-body">
          <p>I know it is our fault (for taking so long to test and apply it), but this patch is now out of date (source code has changed since you submitted this patch).</p>
          <p>If possible, please re-submit it for the current svn code and since you will do that, please submit separate patches for contrib plugins because they would have to be approved by their respective authors.</p>
          <p>Thank you for your efforts.</p>
        </div>
      </div>
      <div class="panel panel-default">
        <div class="panel-heading">jthedering 2007-04-23 23:35:56</div>
        <div class="panel-body">
          <p>Thank you for your interest.</p>
          <p>This is a remade version of the patch for the latest svn code (revision 3882).</p>
        </div>
      </div>
    </div>

    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
    <!-- Include all compiled plugins (below), or include individual files as needed -->
    <script src="https://netdna.bootstrapcdn.com/bootstrap/3.1.1/js/bootstrap.min.js"></script>
  </body>
</html>
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Patch 2886 - Code::Blocks History</title>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap-theme.min.css">
  </head>
  <body role="document">
    <div class="navbar navbar-inverse" role="navigation">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="http://www.codeblocks.org/">Code::Blocks</a>
        </div>
        <div class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
            <li><a href="../index.html">Home</a></li>
            <li><a href="../bugs.html">Bugs</a></li>
            <li><a href="../features.html">Features</a></li>
            <li class="active"><a href="../patches.html">Patches</a></li>
          </ul>
        </div>
      </div>
    </div>

    <div class="container" role="main">
      <div class="row">
        <div class="col-sm-8">
          <h3>Patch #2886 <small>2009-12-27 21:51</small></h3>
          <h4>techy</h4>
          Fixes for browsetracker (debug14)
          <dl class="dl-horizontal">
            <dt>Download</dt>
            <dd><a href="2886-Fixes_for_brow.patch">2886-Fixes_for_brow.patch</a> (2.3 KB)</dd>
          </dl>
        </div>
        <div class="col-sm-4">
          <dl class="dl-horizontal">
            <dt>Category</dt><dd>Plugin::Bugfix</dd>
            <dt>Status</dt><dd>Accepted</dd>
            <dt>Close date</dt><dd>2010-02-25 21:50 <a href="http://cb.biplab.in/websvn/log.php?sr=6179"><span class="glyphicon glyphicon-link"></span></a></dd>
            <dt>Assigned to</dt><dd>pecan</dd>
          </dl>
        </div>
      </div>
      <div class="highlight"><pre class="pre-scrollable"><span class="gh">Index: src/plugins/contrib/BrowseTracker/BrowseTracker.cpp</span>
<span class="gh">===================================================================</span>
<span class="gd">--- src/plugins/contrib/BrowseTracker/BrowseTracker.cpp    (revision 5986)</span>
<span class="gi">+++ src/plugins/contrib/BrowseTracker/BrowseTracker.cpp    (working copy)</span>
<span class="gu">@@ -215,8 +215,7 @@</span>
     m_InitDone = false;
     m_CurrEditorIndex = 0;
     m_LastEditorIndex = MaxEntries-1;
<span class="gd">-    m_apEditors.Alloc(MaxEntries);</span>
<span class="gd">-    for (int i=0; i&lt;MaxEntries ; ++i ) m_apEditors[i] = 0;</span>
<span class="gi">+    m_apEditors.SetCount(MaxEntries, 0);</span>
     m_nBrowsedEditorCount = 0;
     m_UpdateUIFocusEditor = 0;
     m_nRemoveEditorSentry = 0;
<span class="gu">@@ -504,11 +503,11 @@</span>
         int menuId = item-&gt;GetId();
         wxString menuLabel = item-&gt;GetLabel();
         ///LOGIT( _T(&quot;BT OnContextMenu insert[%s]&quot;),menuLabel.c_str() );
<span class="gd">-        wxMenuItem* pContextItem= new wxMenuItem(0, menuId, menuLabel);</span>
<span class="gi">+        wxMenuItem* pContextItem= new wxMenuItem(sub_menu, menuId, menuLabel);</span>
         sub_menu-&gt;Append( pContextItem );
     }
     popup-&gt;AppendSeparator();
<span class="gd">-    pbtMenuItem = new wxMenuItem(0, wxID_ANY, _(&quot;Browse Tracker&quot;), _T(&quot;&quot;), wxITEM_NORMAL);</span>
<span class="gi">+    pbtMenuItem = new wxMenuItem(sub_menu, wxID_ANY, _(&quot;Browse Tracker&quot;), _T(&quot;&quot;), wxITEM_NORMAL);</span>
     pbtMenuItem-&gt;SetSubMenu(sub_menu);
     popup-&gt;Append(pbtMenuItem);
 
<span class="gu">@@ -2181,7 +2180,7 @@</span>
         tmpArray.Alloc(MaxEntries);
         // copy current editors &amp; clear for compression
         for (int i = 0; i&lt;MaxEntries; ++i)
<span class="gd">-        {   tmpArray[i] = m_apEditors[i];</span>
<span class="gi">+        {   tmpArray.Add(m_apEditors[i]);</span>
             m_apEditors[i] = 0;
         }//for
         m_CurrEditorIndex = 0;
<span class="gh">Index: src/plugins/contrib/BrowseTracker/BrowseMarks.cpp</span>
<span class="gh">===================================================================</span>
<span class="gd">--- src/plugins/contrib/BrowseTracker/BrowseMarks.cpp    (revision 5986)</span>
<span class="gi">+++ src/plugins/contrib/BrowseTracker/BrowseMarks.cpp    (working copy)</span>
<span class="gu">@@ -65,9 +65,7 @@</span>
     //LOGIT( _T(&quot;BT BrowseMarks[%s][%s]&quot;),m_filePath.c_str() ,m_fileShortName.c_str() );
     //#endif
 
<span class="gd">-    m_EdPosnArray.Alloc(MaxEntries);</span>
<span class="gd">-    for (int i=0; i &lt; MaxEntries; ++i )</span>
<span class="gd">-        m_EdPosnArray[i] = -1;</span>
<span class="gi">+    m_EdPosnArray.SetCount(MaxEntries, -1);</span>
     m_currIndex = 0;    //index of current entry
     m_lastIndex = MaxEntries-1;    //index for insertion of new browse marks
     m_pEdMgr = Manager::Get()-&gt;GetEditorManager();
</pre></div>

      <h4 class="page-header">History</h4>
      <div class="panel panel-default">
        <div class="panel-heading">techy 2009-12-27 22:00</div>
        <div class="panel-body">
          <p>The problems in browsetracker are a result of misunderstanding of what the method Alloc() of wxArray does - it only preallocates enough memory (to prevent reallocations of the memory space) but it _doesn't_ change the size of the array. So if you call Alloc(1000) and then GetCount(), the result will be 0. So either you have to Alloc the space and then Add your elements, or call SetCount() which allocates the memory _and_ adds the elements with some default value (both methods used in the patch).</p>
          <p>(this is the last patch of the series)</p>
        </div>
      </div>
      <div class="panel panel-default">
        <div class="panel-heading">techy 2009-12-27 22:15</div>
        <div class="panel-body">
          <p>Forgot to mention one more problem - elements of the popup window didn't have the parent window set.</p>
        </div>
      </div>
      <div class="panel panel-default">
        <div class="panel-heading">mortenmacfly 2009-12-28 19:58</div>
        <div class="panel-body">
          <p>I leave this open and un-assigned for the (active) maintainer of this plugin to take action. If nothing happens for a while, drop me a note (just a comment here).</p>
        </div>
      </div>
      <div class="panel panel-default">
        <div class="panel-heading">mortenmacfly 2010-02-24 12:22</div>
        <div class="panel-body">
          <p>Of interest to Pecan.</p>
        </div>
      </div>
      <div class="panel panel-default">
        <div class="panel-heading">pecan 2010-02-25 21:50</div>
        <div class="panel-body">
          <p>Applied. Svn 6179</p>
          <p>Thanks</p>
        </div>
      </div>
    </div>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.0/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>
  </body>
</html>

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Patch 1726 - Code::Blocks History</title>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap-theme.min.css">
    <link rel="stylesheet" href="../pygments.css">
  </head>
  <body role="document">
    <div class="navbar navbar-inverse" role="navigation">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="http://www.codeblocks.org/">Code::Blocks</a>
        </div>
        <div class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
            <li><a href="../index.html">Home</a></li>
            <li><a href="../bugs.html">Bugs</a></li>
            <li><a href="../features.html">Features</a></li>
            <li class="active"><a href="../patches.html">Patches</a></li>
          </ul>
        </div>
      </div>
    </div>

    <div class="container" role="main">
      <div class="row">
        <div class="col-sm-8">
          <h3>Patch #1726 <small>2006-12-16 13:56</small></h3>
          <h4>mcdave</h4>
          Fold all of the procedures at the same line
          <dl class="dl-horizontal">
            <dt>Download</dt>
            <dd><a href="1726-Fold_all_of_th.patch">1726-Fold_all_of_th.patch</a> (3.1 KB)</dd>
          </dl>
        </div>
        <div class="col-sm-4">
          <dl class="dl-horizontal">
            <dt>Category</dt><dd>&nbsp;</dd>
            <dt>Status</dt><dd>Rejected</dd>
            <dt>Close date</dt><dd>2007-04-12 12:51</dd>
            <dt>Assigned to</dt><dd>killerbot</dd>
          </dl>
        </div>
      </div>
      <div class="highlight"><pre class="pre-scrollable"><span class="gh">Index: src/sdk/wxscintilla/src/scintilla/src/LexCPP.cxx</span>
<span class="gh">===================================================================</span>
<span class="gd">--- src/sdk/wxscintilla/src/scintilla/src/LexCPP.cxx    (revision 3455)</span>
<span class="gi">+++ src/sdk/wxscintilla/src/scintilla/src/LexCPP.cxx    (working copy)</span>
<span class="gu">@@ -97,7 +97,7 @@</span>
 
         if (sc.atLineStart) {
             if (sc.state == SCE_C_STRING) {
<span class="gd">-                // Prevent SCE_C_STRINGEOL from leaking back to previous line which </span>
<span class="gi">+                // Prevent SCE_C_STRINGEOL from leaking back to previous line which</span>
                 // ends with a line continuation by locking in the state upto this position.
                 sc.SetState(SCE_C_STRING);
             }
<span class="gu">@@ -399,16 +399,61 @@</span>
             }
         }
         if (style == SCE_C_OPERATOR) {
<span class="gd">-            if (ch == &#39;{&#39;) {</span>
<span class="gd">-                // Measure the minimum before a &#39;{&#39; to allow</span>
<span class="gd">-                // folding on &quot;} else {&quot;</span>
<span class="gd">-                if (levelMinCurrent &gt; levelNext) {</span>
<span class="gd">-                    levelMinCurrent = levelNext;</span>
<span class="gd">-                }</span>
<span class="gd">-                levelNext++;</span>
<span class="gd">-            } else if (ch == &#39;}&#39;) {</span>
<span class="gd">-                levelNext--;</span>
<span class="gd">-            }</span>
<span class="gi">+            if (ch == &#39;{&#39;)</span>
<span class="gi">+            {</span>
<span class="gi">+               // Measure the minimum before a &#39;{&#39; to allow</span>
<span class="gi">+               // folding on &quot;} else {&quot;</span>
<span class="gi">+               if(visibleChars == 0)</span>
<span class="gi">+               {</span>
<span class="gi">+                  bool foundBracket = false;</span>
<span class="gi">+                  int thisCharPosition = i - 1;</span>
<span class="gi">+                  int thisLinePosition = lineCurrent;</span>
<span class="gi">+                  char thisChar = &#39;{&#39;;</span>
<span class="gi">+                  while(foundBracket == false &amp;&amp; thisCharPosition &gt; startPos)</span>
<span class="gi">+                  {</span>
<span class="gi">+                     thisChar = styler.SafeGetCharAt(thisCharPosition);</span>
<span class="gi">+                     if(!isspacechar(thisChar) == true)</span>
<span class="gi">+                     {</span>
<span class="gi">+                        foundBracket = true;</span>
<span class="gi">+                        thisLinePosition = styler.GetLine(thisCharPosition);</span>
<span class="gi">+                     }</span>
<span class="gi">+                     thisCharPosition--;</span>
<span class="gi">+                  }</span>
<span class="gi">+                  if(foundBracket == true)</span>
<span class="gi">+                  {</span>
<span class="gi">+                     if (levelMinCurrent &gt; levelNext)</span>
<span class="gi">+                     {</span>
<span class="gi">+                        levelMinCurrent = levelNext;</span>
<span class="gi">+                     }</span>
<span class="gi">+                     levelNext++;</span>
<span class="gi">+                     while(thisLinePosition != lineCurrent)</span>
<span class="gi">+                     {</span>
<span class="gi">+                         int levelUse = levelCurrent;</span>
<span class="gi">+                         int lev = levelUse | levelNext &lt;&lt; 16;</span>
<span class="gi">+                        if (visibleChars == 0 &amp;&amp; foldCompact)</span>
<span class="gi">+                           lev |= SC_FOLDLEVELWHITEFLAG;</span>
<span class="gi">+                        if (levelUse &lt; levelNext)</span>
<span class="gi">+                           lev |= SC_FOLDLEVELHEADERFLAG;</span>
<span class="gi">+                         styler.SetLevel(thisLinePosition, lev);</span>
<span class="gi">+                         thisLinePosition++;</span>
<span class="gi">+                         levelCurrent = levelNext;</span>
<span class="gi">+                         levelMinCurrent = levelCurrent;</span>
<span class="gi">+                     }</span>
<span class="gi">+                  }</span>
<span class="gi">+               }</span>
<span class="gi">+               else</span>
<span class="gi">+               {</span>
<span class="gi">+                  if (levelMinCurrent &gt; levelNext)</span>
<span class="gi">+                  {</span>
<span class="gi">+                     levelMinCurrent = levelNext;</span>
<span class="gi">+                  }</span>
<span class="gi">+                  levelNext++;</span>
<span class="gi">+               }</span>
<span class="gi">+            }</span>
<span class="gi">+            else if (ch == &#39;}&#39;)</span>
<span class="gi">+            {</span>
<span class="gi">+                levelNext--;</span>
<span class="gi">+            }</span>
         }
         if (atEOL) {
             int levelUse = levelCurrent;
</pre></div>

      <h4 class="page-header">History</h4>
      <div class="panel panel-default">
        <div class="panel-heading">killerbot 2006-12-18 19:52</div>
        <div class="panel-body">
          <p>could you explain a bit more what is changing, and why it is needed.</p>
          <p>By the way have a look at this (wrt previous applied patches) : <a href="http://forums.codeblocks.org/index.php?topic=4724.msg37157" data-toggle="tooltip" title="New folding features...">http://forums.codeblocks.org/index.php?topic=4724.msg37157</a>#msg37157</p>
        </div>
      </div>
      <div class="panel panel-default">
        <div class="panel-heading">mcdave 2006-12-19 05:35</div>
        <div class="panel-body">
          <p>Well it is only a cosmetic feature. When you fold a block of code, the fold line will always be where the '{' character is. I added the feature that if the '{' is the character in the line, it will find the first valid character to make that line its fold line. So far it works great... I hope...</p>
        </div>
      </div>
      <div class="panel panel-default">
        <div class="panel-heading">mcdave 2007-01-04 07:03</div>
        <div class="panel-body">
          <p>What is it with me and the AStyle patches... it changes the whole file without determining the changes... Sorry about that... here is the changes without the AStyle.</p>
        </div>
      </div>
      <div class="panel panel-default">
        <div class="panel-heading">mandrav 2007-04-12 12:51</div>
        <div class="panel-body">
          <p>Sorry for responding so late, but this patch cannot be applied. Folding the line where { exists, is a strong scintilla's feature which this patch almost invalidates.</p>
          <p>The reasoning is simple: you can manually add folding points anywhere in your code just by adding a { in a comment (like //{ and //}). With this patch, everyone using this feature will be upset because they would then have to update their *code* so that it behaves like they are used to.</p>
          <p>If that's not enough reason, here's a more strong point: we do not accept patches for scintilla/wxScintilla/wxPropGrid/wxFlatNotebook. We update these components using their source releases, when we have tested them well enough.</p>
          <p>Meaning that if you insist on changing this scintilla functionality, you would have to submit the patch to the scintilla team.</p>
          <p>Thanks for your effort though.</p>
        </div>
      </div>
    </div>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.0/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>
    <script>
      $(document).ready(function() {
        $("body").tooltip({ selector: '[data-toggle=tooltip]' });
      });
    </script>
  </body>
</html>

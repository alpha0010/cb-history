<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Patch 2874 - Code::Blocks History</title>

    <!-- Bootstrap -->
    <link rel="stylesheet" href="https://netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap-theme.min.css">

    <link rel="stylesheet" href="../pygments.css">

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
      <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->
  </head>
  <body role="document">
    <div class="navbar navbar-inverse" role="navigation">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="http://www.codeblocks.org/">Code::Blocks</a>
        </div>
        <div class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
            <li><a href="../index.html">Home</a></li>
            <li><a href="../bugs.html">Bugs</a></li>
            <li><a href="../features.html">Features</a></li>
            <li class="active"><a href="../patches.html">Patches</a></li>
          </ul>
        </div>
      </div>
    </div>

    <div class="container" role="main">
      <div class="row">
        <div class="col-sm-8">
          <h3>Patch #2874 <small>2009-12-27 16:24:45</small></h3>
          <h4>techy</h4>
          OnPageChanged called upon creation (debug2)
          <dl class="dl-horizontal">
            <dt>Download</dt>
            <dd><a href="2874-OnPageChanged.patch">2874-OnPageChanged.patch</a> (4.6 KB)</dd>
          </dl>
        </div>
        <div class="col-sm-4">
          <dl class="dl-horizontal">
            <dt>Category</dt><dd>Application::Bugfix</dd>
            <dt>Status</dt><dd>Accepted</dd>
            <dt>Close date</dt><dd>2009-12-31 16:59:53 <a href="http://cb.biplab.in/websvn/log.php?sr=6014"><span class="glyphicon glyphicon-link"></span></a></dd>
            <dt>Assigned to</dt><dd>mortenmacfly</dd>
          </dl>
        </div>
      </div>
      <div class="highlight"><pre class="pre-scrollable"><span class="gh">Index: src/sdk/editorconfigurationdlg.cpp</span>
<span class="gh">===================================================================</span>
<span class="gd">--- src/sdk/editorconfigurationdlg.cpp    (revision 5986)</span>
<span class="gi">+++ src/sdk/editorconfigurationdlg.cpp    (working copy)</span>
<span class="gu">@@ -339,7 +339,11 @@</span>
 
 void EditorConfigurationDlg::OnPageChanged(wxListbookEvent&amp; event)
 {
<span class="gd">-    UpdateListbookImages();</span>
<span class="gi">+    // update only on real change, not on dialog creation</span>
<span class="gi">+    if (event.GetOldSelection() != -1 &amp;&amp; event.GetSelection() != -1)</span>
<span class="gi">+    {</span>
<span class="gi">+        UpdateListbookImages();</span>
<span class="gi">+    }</span>
 }
 
 void EditorConfigurationDlg::CreateColoursSample()
<span class="gh">Index: src/src/compilersettingsdlg.cpp</span>
<span class="gh">===================================================================</span>
<span class="gd">--- src/src/compilersettingsdlg.cpp    (revision 5986)</span>
<span class="gi">+++ src/src/compilersettingsdlg.cpp    (working copy)</span>
<span class="gu">@@ -216,7 +216,11 @@</span>
 
 void CompilerSettingsDlg::OnPageChanged(wxListbookEvent&amp; event)
 {
<span class="gd">-    UpdateListbookImages();</span>
<span class="gi">+    // update only on real change, not on dialog creation</span>
<span class="gi">+    if (event.GetOldSelection() != -1 &amp;&amp; event.GetSelection() != -1)</span>
<span class="gi">+    {</span>
<span class="gi">+        UpdateListbookImages();</span>
<span class="gi">+    }</span>
 }
 
 void CompilerSettingsDlg::EndModal(int retCode)
<span class="gh">Index: src/src/environmentsettingsdlg.cpp</span>
<span class="gh">===================================================================</span>
<span class="gd">--- src/src/environmentsettingsdlg.cpp    (revision 5986)</span>
<span class="gi">+++ src/src/environmentsettingsdlg.cpp    (working copy)</span>
<span class="gu">@@ -291,7 +291,11 @@</span>
 
 void EnvironmentSettingsDlg::OnPageChanged(wxListbookEvent&amp; event)
 {
<span class="gd">-    UpdateListbookImages();</span>
<span class="gi">+    // update only on real change, not on dialog creation</span>
<span class="gi">+    if (event.GetOldSelection() != -1 &amp;&amp; event.GetSelection() != -1)</span>
<span class="gi">+    {</span>
<span class="gi">+        UpdateListbookImages();</span>
<span class="gi">+    }</span>
 }
 
 void EnvironmentSettingsDlg::OnSetAssocs(wxCommandEvent&amp; event)
<span class="gh">Index: src/sdk/finddlg.cpp</span>
<span class="gh">===================================================================</span>
<span class="gd">--- src/sdk/finddlg.cpp    (revision 5986)</span>
<span class="gi">+++ src/sdk/finddlg.cpp    (working copy)</span>
<span class="gu">@@ -289,22 +289,23 @@</span>
 
 void FindDlg::OnFindChange(wxNotebookEvent&amp; event)
 {
<span class="gd">-    wxComboBox* cmbFind1 = XRCCTRL(*this, &quot;cmbFind1&quot;, wxComboBox);</span>
<span class="gd">-    wxComboBox* cmbFind2 = XRCCTRL(*this, &quot;cmbFind2&quot;, wxComboBox);</span>
<span class="gi">+    if (    (event.GetOldSelection() == 0 &amp;&amp; event.GetSelection() == 1)</span>
<span class="gi">+         || (event.GetOldSelection() == 1 &amp;&amp; event.GetSelection() == 0))</span>
<span class="gi">+    {</span>
<span class="gi">+        wxComboBox* cmbFind1 = XRCCTRL(*this, &quot;cmbFind1&quot;, wxComboBox);</span>
<span class="gi">+        wxComboBox* cmbFind2 = XRCCTRL(*this, &quot;cmbFind2&quot;, wxComboBox);</span>
 
<span class="gd">-    if (cmbFind1 &amp;&amp; cmbFind2)</span>
<span class="gd">-    {</span>
<span class="gd">-        if (XRCCTRL(*this, &quot;nbFind&quot;, wxNotebook)-&gt;GetSelection() == 1)</span>
<span class="gi">+        if (event.GetSelection() == 0)</span>
         {
<span class="gd">-            cmbFind2-&gt;SetValue(cmbFind1-&gt;GetValue());</span>
<span class="gd">-            cmbFind2-&gt;SetFocus();</span>
<span class="gi">+            cmbFind1-&gt;SetValue(cmbFind2-&gt;GetValue());</span>
<span class="gi">+            cmbFind1-&gt;SetFocus();            </span>
         }
<span class="gd">-        else</span>
<span class="gi">+        else if (event.GetSelection() == 1)</span>
         {
<span class="gd">-            cmbFind1-&gt;SetValue(cmbFind2-&gt;GetValue());</span>
<span class="gd">-            cmbFind1-&gt;SetFocus();</span>
<span class="gi">+            cmbFind2-&gt;SetValue(cmbFind1-&gt;GetValue());</span>
<span class="gi">+            cmbFind2-&gt;SetFocus();            </span>
         }
<span class="gd">-    }</span>
<span class="gi">+    }    </span>
     event.Skip();
 }
 
<span class="gh">Index: src/sdk/replacedlg.cpp</span>
<span class="gh">===================================================================</span>
<span class="gd">--- src/sdk/replacedlg.cpp    (revision 5986)</span>
<span class="gi">+++ src/sdk/replacedlg.cpp    (working copy)</span>
<span class="gu">@@ -243,22 +243,27 @@</span>
 
 void ReplaceDlg::OnFindChange(wxNotebookEvent&amp; event)
 {
<span class="gd">-    wxComboBox* cmbFind1 = XRCCTRL(*this, &quot;cmbFind1&quot;, wxComboBox);</span>
<span class="gd">-    wxComboBox* cmbFind2 = XRCCTRL(*this, &quot;cmbFind2&quot;, wxComboBox);</span>
<span class="gi">+    if (    (event.GetOldSelection() == 0 &amp;&amp; event.GetSelection() == 1)</span>
<span class="gi">+         || (event.GetOldSelection() == 1 &amp;&amp; event.GetSelection() == 0))</span>
<span class="gi">+    {</span>
<span class="gi">+        wxComboBox* cmbFind1 = XRCCTRL(*this, &quot;cmbFind1&quot;, wxComboBox);</span>
<span class="gi">+        wxComboBox* cmbFind2 = XRCCTRL(*this, &quot;cmbFind2&quot;, wxComboBox);</span>
<span class="gi">+        wxComboBox* cmbReplace1 =XRCCTRL(*this, &quot;cmbReplace1&quot;, wxComboBox);</span>
<span class="gi">+        wxComboBox* cmbReplace2 =XRCCTRL(*this, &quot;cmbReplace2&quot;, wxComboBox);</span>
 
<span class="gd">-    if (cmbFind1 &amp;&amp; cmbFind2)</span>
<span class="gd">-    {</span>
<span class="gd">-        if (XRCCTRL(*this, &quot;nbReplace&quot;, wxNotebook)-&gt;GetSelection() == 1)</span>
<span class="gi">+        if (event.GetSelection() == 0)</span>
         {
<span class="gd">-            cmbFind2-&gt;SetValue(cmbFind1-&gt;GetValue());</span>
<span class="gd">-            cmbFind2-&gt;SetFocus();</span>
<span class="gi">+            cmbFind1-&gt;SetValue(cmbFind2-&gt;GetValue());</span>
<span class="gi">+            cmbReplace1-&gt;SetValue(cmbReplace2-&gt;GetValue());</span>
<span class="gi">+            cmbFind1-&gt;SetFocus();            </span>
         }
<span class="gd">-        else</span>
<span class="gi">+        else if (event.GetSelection() == 1)</span>
         {
<span class="gd">-            cmbFind1-&gt;SetValue(cmbFind2-&gt;GetValue());</span>
<span class="gd">-            cmbFind1-&gt;SetFocus();</span>
<span class="gi">+            cmbFind2-&gt;SetValue(cmbFind1-&gt;GetValue());</span>
<span class="gi">+            cmbReplace2-&gt;SetValue(cmbReplace1-&gt;GetValue());</span>
<span class="gi">+            cmbFind2-&gt;SetFocus();            </span>
         }
<span class="gd">-    }</span>
<span class="gi">+    }    </span>
     event.Skip();
 }
 
</pre></div>

      <h4 class="page-header">History</h4>
      <div class="panel panel-default">
        <div class="panel-heading">techy 2009-12-27 16:33:35</div>
        <div class="panel-body">
          <p>EVT_LISTBOOK_PAGE_CHANGED and EVT_NOTEBOOK_PAGE_CHANGED are called even when the tabs are created. In several cases (for instance in the Find dialogue), codeblocks tries to access the other tabs (for instance for search to copy the search string from the other tab), which fails, because they are not created yet. In these situations you don't want the contents of the callback to be executed so I added a check whether we are switching from or switching to an existing tab. The same applies for notebook in settings diologues.</p>
          <p>While there, I also made the "replace with" field of replace dialogue to copy the contents when switching between tabs.</p>
        </div>
      </div>
      <div class="panel panel-default">
        <div class="panel-heading">mortenmacfly 2009-12-28 19:23:44</div>
        <div class="panel-body">
          <p>The replace thingy might become a little difficult, as it conflicts with another patch created by rickg22 (multi line replace). However, I hopefully can manage...</p>
        </div>
      </div>
    </div>

    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
    <!-- Include all compiled plugins (below), or include individual files as needed -->
    <script src="https://netdna.bootstrapcdn.com/bootstrap/3.1.1/js/bootstrap.min.js"></script>
  </body>
</html>
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Patch 3103 - Code::Blocks History</title>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap-theme.min.css">
    <link rel="stylesheet" href="../pygments.css">
  </head>
  <body role="document">
    <div class="navbar navbar-inverse" role="navigation">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="http://www.codeblocks.org/">Code::Blocks</a>
        </div>
        <div class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
            <li><a href="../index.html">Home</a></li>
            <li><a href="../bugs.html">Bugs</a></li>
            <li><a href="../features.html">Features</a></li>
            <li class="active"><a href="../patches.html">Patches</a></li>
          </ul>
        </div>
      </div>
    </div>

    <div class="container" role="main">
      <div class="row">
        <div class="col-sm-8">
          <h3>Patch #3103 <small>2010-12-16 22:12</small></h3>
          <h4>danselmi</h4>
          Make GetCommentLexerStyle() and friends langauge dependant.
          <dl class="dl-horizontal">
            <dt>Download</dt>
            <dd><a href="3103-Make_GetCommen.patch">3103-Make_GetCommen.patch</a> (16.2 KB)</dd>
          </dl>
        </div>
        <div class="col-sm-4">
          <dl class="dl-horizontal">
            <dt>Category</dt><dd>Application::Refinement</dd>
            <dt>Status</dt><dd>Accepted</dd>
            <dt>Close date</dt><dd>2010-12-27 15:31 <a href="http://cb.biplab.in/websvn/log.php?sr=6906"><span class="glyphicon glyphicon-link"></span></a></dd>
            <dt>Assigned to</dt><dd>mortenmacfly</dd>
          </dl>
        </div>
      </div>
      <div class="highlight"><pre class="pre-scrollable"><span class="gh">Index: include/cbstyledtextctrl.h</span>
<span class="gh">===================================================================</span>
<span class="gd">--- include/cbstyledtextctrl.h    (revision 6863)</span>
<span class="gi">+++ include/cbstyledtextctrl.h    (working copy)</span>
<span class="gu">@@ -9,6 +9,9 @@</span>
 #include &quot;wx/wxscintilla.h&quot;
 #include &lt;wx/longlong.h&gt;
 
<span class="gi">+#include &lt;map&gt;</span>
<span class="gi">+#include &lt;set&gt;</span>
<span class="gi">+</span>
 class wxContextMenuEvent;
 class wxFocusEvent;
 class wxMouseEvent;
<span class="gu">@@ -27,6 +30,11 @@</span>
         bool IsComment(int style);
         void CallTipCancel();
 
<span class="gi">+        static std::map&lt;int, std::set&lt;int&gt; &gt; &amp;GetCharacterLexerStyles();</span>
<span class="gi">+        static std::map&lt;int, std::set&lt;int&gt; &gt; &amp;GetStringLexerStyles();</span>
<span class="gi">+        static std::map&lt;int, std::set&lt;int&gt; &gt; &amp;GetPreprocessorLexerStyles();</span>
<span class="gi">+        static std::map&lt;int, std::set&lt;int&gt; &gt; &amp;GetCommentLexerStyles();</span>
<span class="gi">+</span>
     private:
         void OnContextMenu(wxContextMenuEvent&amp; event);
         void OnKillFocus(wxFocusEvent&amp; event);
<span class="gu">@@ -45,6 +53,8 @@</span>
         int m_lastPosition;
         bool m_tabSmartJump;
 
<span class="gi">+        static std::map&lt;int, std::set&lt;int&gt; &gt; CharacterLexerStyles, StringLexerStyles, PreprocessorLexerStyles, CommentLexerStyles;</span>
<span class="gi">+</span>
         DECLARE_EVENT_TABLE()
 };
 
<span class="gh">Index: include/editorcolourset.h</span>
<span class="gh">===================================================================</span>
<span class="gd">--- include/editorcolourset.h    (revision 6863)</span>
<span class="gi">+++ include/editorcolourset.h    (working copy)</span>
<span class="gu">@@ -13,6 +13,8 @@</span>
 #include &quot;settings.h&quot;
 #include &quot;globals.h&quot; // HighlightLanguage
 
<span class="gi">+#include &lt;set&gt;</span>
<span class="gi">+</span>
 // forward decls
 class cbEditor;
 class cbStyledTextCtrl;
<span class="gu">@@ -65,6 +67,7 @@</span>
 
     CommentToken comment;
     bool m_CaseSensitive;
<span class="gi">+    //std::set&lt;int&gt; CommentStyles, StringStyles, CharacterStyles, PreprocessorStyles;</span>
 };
 WX_DECLARE_STRING_HASH_MAP(OptionSet, OptionSetsMap);
 
<span class="gu">@@ -113,6 +116,10 @@</span>
         void SetCommentToken(HighlightLanguage lang, CommentToken token);
         bool GetCaseSensitivity(HighlightLanguage lang);
         void SetCaseSensitivity(HighlightLanguage lang, bool CaseSensitive);
<span class="gi">+        void SetStringLexerStyles(HighlightLanguage lang, const std::set&lt;int&gt; &amp;styles);</span>
<span class="gi">+        void SetCommentLexerStyles(HighlightLanguage lang, const std::set&lt;int&gt; &amp;styles);</span>
<span class="gi">+        void SetCharacterLexerStyles(HighlightLanguage lang, const std::set&lt;int&gt; &amp;styles);</span>
<span class="gi">+        void SetPreprocessorLexerStyles(HighlightLanguage lang, const std::set&lt;int&gt; &amp;styles);</span>
     protected:
     private:
         void DoApplyStyle(cbStyledTextCtrl* control, int value, OptionColour* option);
<span class="gh">Index: include/editorlexerloader.h</span>
<span class="gh">===================================================================</span>
<span class="gd">--- include/editorlexerloader.h    (revision 6863)</span>
<span class="gi">+++ include/editorlexerloader.h    (working copy)</span>
<span class="gu">@@ -26,6 +26,7 @@</span>
         void DoSingleKeywordNode(HighlightLanguage language, TiXmlElement* node, const wxString&amp; nodename);
         void DoSampleCode(HighlightLanguage language, TiXmlElement* node);
         void DoLangAttributes(HighlightLanguage language, TiXmlElement* node);
<span class="gi">+        bool DoLangAttributesLexerStyles(TiXmlElement* attribs, const char *attributeName, std::set&lt;int&gt; &amp;styles);</span>
         EditorColourSet* m_pTarget;
     private:
 };
<span class="gh">Index: sdk/cbstyledtextctrl.cpp</span>
<span class="gh">===================================================================</span>
<span class="gd">--- sdk/cbstyledtextctrl.cpp    (revision 6863)</span>
<span class="gi">+++ sdk/cbstyledtextctrl.cpp    (working copy)</span>
<span class="gu">@@ -22,6 +22,11 @@</span>
 static const wxString s_rightBrace(_T(&quot;)]}&#39;\&quot;&quot;));
 static const int s_indicHighlight(20);
 
<span class="gi">+std::map&lt;int, std::set&lt;int&gt; &gt; cbStyledTextCtrl::CharacterLexerStyles;</span>
<span class="gi">+std::map&lt;int, std::set&lt;int&gt; &gt; cbStyledTextCtrl::StringLexerStyles;</span>
<span class="gi">+std::map&lt;int, std::set&lt;int&gt; &gt; cbStyledTextCtrl::PreprocessorLexerStyles;</span>
<span class="gi">+std::map&lt;int, std::set&lt;int&gt; &gt; cbStyledTextCtrl::CommentLexerStyles;</span>
<span class="gi">+</span>
 BEGIN_EVENT_TABLE(cbStyledTextCtrl, wxScintilla)
     EVT_CONTEXT_MENU(cbStyledTextCtrl::OnContextMenu)
     EVT_KILL_FOCUS  (cbStyledTextCtrl::OnKillFocus)
<span class="gu">@@ -247,61 +252,22 @@</span>
 
 bool cbStyledTextCtrl::IsCharacter(int style)
 {
<span class="gd">-    switch (GetLexer())</span>
<span class="gd">-    {</span>
<span class="gd">-    case wxSCI_LEX_CPP:</span>
<span class="gd">-        return style == wxSCI_C_CHARACTER;</span>
<span class="gd">-    case wxSCI_LEX_D:</span>
<span class="gd">-        return style == wxSCI_D_CHARACTER;</span>
<span class="gd">-    default:</span>
<span class="gd">-        return false;</span>
<span class="gd">-    }</span>
<span class="gd">-    return false;</span>
<span class="gi">+    return CharacterLexerStyles[GetLexer()].find(style) != CharacterLexerStyles[GetLexer()].end();</span>
 }
 
 bool cbStyledTextCtrl::IsString(int style)
 {
<span class="gd">-    switch (GetLexer())</span>
<span class="gd">-    {</span>
<span class="gd">-    case wxSCI_LEX_CPP:</span>
<span class="gd">-        return style == wxSCI_C_STRING;</span>
<span class="gd">-    case wxSCI_LEX_D:</span>
<span class="gd">-        return style == wxSCI_D_STRING;</span>
<span class="gd">-    default:</span>
<span class="gd">-        return false;</span>
<span class="gd">-    }</span>
<span class="gd">-    return false;</span>
<span class="gi">+    return StringLexerStyles[GetLexer()].find(style) != StringLexerStyles[GetLexer()].end();</span>
 }
 
 bool cbStyledTextCtrl::IsPreprocessor(int style)
 {
<span class="gd">-    if (GetLexer() == wxSCI_LEX_CPP)</span>
<span class="gd">-        return  style == wxSCI_C_PREPROCESSOR;</span>
<span class="gd">-    return false;</span>
<span class="gi">+    return PreprocessorLexerStyles[GetLexer()].find(style) != PreprocessorLexerStyles[GetLexer()].end();</span>
 }
 
 bool cbStyledTextCtrl::IsComment(int style)
 {
<span class="gd">-    switch (GetLexer())</span>
<span class="gd">-    {</span>
<span class="gd">-    case wxSCI_LEX_CPP:</span>
<span class="gd">-</span>
<em><strong>download for full patch...</strong></em>
</pre></div>

      <h4 class="page-header">History</h4>
      
    </div>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.0/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>
  </body>
</html>

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Patch 3377 - Code::Blocks History</title>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap-theme.min.css">
  </head>
  <body role="document">
    <div class="navbar navbar-inverse" role="navigation">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="http://www.codeblocks.org/">Code::Blocks</a>
        </div>
        <div class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
            <li><a href="../index.html">Home</a></li>
            <li><a href="../bugs.html">Bugs</a></li>
            <li><a href="../features.html">Features</a></li>
            <li class="active"><a href="../patches.html">Patches</a></li>
          </ul>
        </div>
      </div>
    </div>

    <div class="container" role="main">
      <div class="row">
        <div class="col-sm-8">
          <h3>Patch #3377 <small>2012-11-24 07:56</small></h3>
          <h4>darmar</h4>
          DoxyBlocks: adds Fortran language support
          <dl class="dl-horizontal">
            <dt>Download</dt>
            <dd><a href="3377-DoxyBlocks_add.patch">3377-DoxyBlocks_add.patch</a> (7.0 KB)</dd>
          </dl>
        </div>
        <div class="col-sm-4">
          <dl class="dl-horizontal">
            <dt>Category</dt><dd>Plugin::Refinement</dd>
            <dt>Status</dt><dd>Accepted</dd>
            <dt>Close date</dt><dd>2012-12-14 19:37 <a href="http://cb.biplab.in/websvn/log.php?sr=8668"><span class="glyphicon glyphicon-link"></span></a></dd>
            <dt>Assigned to</dt><dd>mortenmacfly</dd>
          </dl>
        </div>
      </div>
      <div class="highlight"><pre class="pre-scrollable"><span class="gh">Index: src/plugins/contrib/DoxyBlocks/DoxyBlocks.h</span>
<span class="gh">===================================================================</span>
<span class="gd">--- src/plugins/contrib/DoxyBlocks/DoxyBlocks.h    (revision 8599)</span>
<span class="gi">+++ src/plugins/contrib/DoxyBlocks/DoxyBlocks.h    (working copy)</span>
<span class="gu">@@ -205,6 +205,8 @@</span>
         void GetBlockCommentStrings(int iBlockComment, wxString &amp;sStartComment, wxString &amp;sMidComment, wxString &amp;sEndComment);
         void StartComment(cbStyledTextCtrl *control, int &amp;iPos, int iBlockComment, wxString sStartComment, wxString sMidComment, wxString sTagBrief, wxString sIndent);
         void CommentFunction(cbStyledTextCtrl *control, int &amp;iPos, wxString sMidComment, wxString sTagParam, wxString sTagReturn, wxString sIndent, wxString sParams, wxString sReturn,  wxString sFunction);
<span class="gi">+        void CommentFortran(cbStyledTextCtrl *control, int iLine, int &amp;iPos, wxString sMidComment, wxString sTagParam, wxString sTagReturn, wxString sIndent);</span>
<span class="gi">+        bool IsLanguageFortran(cbEditor *cbEd);</span>
         void AddCommentLine(cbStyledTextCtrl *control, int &amp;iPos, wxString sText);
         wxString ProcessReturnString(wxString sReturn, wxString sFunction);
         // Autoversioning.
<span class="gh">Index: src/plugins/contrib/DoxyBlocks/AutoDoc.cpp</span>
<span class="gh">===================================================================</span>
<span class="gd">--- src/plugins/contrib/DoxyBlocks/AutoDoc.cpp    (revision 8599)</span>
<span class="gi">+++ src/plugins/contrib/DoxyBlocks/AutoDoc.cpp    (working copy)</span>
<span class="gu">@@ -78,10 +78,18 @@</span>
     // Make the changes undoable in one step.
     control-&gt;BeginUndoAction();
 
<span class="gd">-    if(reClass.Matches(sLine)){                                                    // Class MyClass : public ParentClass</span>
<span class="gi">+    if(IsLanguageFortran(cbEd)){                                      // Fortran</span>
<span class="gi">+        sStartComment = wxT(&quot;!&gt;&quot;);</span>
<span class="gi">+        sMidComment = wxT(&quot;!!&quot;);</span>
<span class="gi">+        sEndComment = wxT(&quot;!!&quot;);</span>
         StartComment(control, iPos, iBlockComment, sStartComment, sMidComment, sTagBrief, sIndent);
<span class="gi">+        CommentFortran(control, line+1, iPos, sMidComment, sTagParam, sTagReturn, sIndent);</span>
         AddCommentLine(control, iPos, sIndent + sEndComment);
     }
<span class="gi">+    else if(reClass.Matches(sLine)){                                                    // Class MyClass : public ParentClass</span>
<span class="gi">+        StartComment(control, iPos, iBlockComment, sStartComment, sMidComment, sTagBrief, sIndent);</span>
<span class="gi">+        AddCommentLine(control, iPos, sIndent + sEndComment);</span>
<span class="gi">+    }</span>
     else if(reStruct.Matches(sLine)){                                            // struct
         StartComment(control, iPos, iBlockComment, sStartComment, sMidComment, sTagBrief, sIndent);
         AddCommentLine(control, iPos, sIndent + sEndComment);
<span class="gu">@@ -176,13 +184,20 @@</span>
             break;
     }
 
<span class="gi">+    int iMax = 5;</span>
<span class="gi">+    if (IsLanguageFortran(cbEd))</span>
<span class="gi">+    {</span>
<span class="gi">+        sComment = wxT(&quot;!&lt; &quot;);</span>
<span class="gi">+        iMax = 3;</span>
<span class="gi">+    }</span>
<span class="gi">+</span>
     // Make the changes undoable in one step.
     control-&gt;BeginUndoAction();
 
     control-&gt;InsertText(iPos, sComment);
     // Position the cursor at the text entry position.
     int i = 0;
<span class="gd">-    while(i &lt; 5){</span>
<span class="gi">+    while(i &lt; iMax){</span>
         control-&gt;CharRight();
         i++;
     }
<span class="gu">@@ -439,3 +454,84 @@</span>
 
     return sReturn;
 }
<span class="gi">+</span>
<span class="gi">+/*! \brief    Add comment lines for a Fortran procedure&#39;s parameters.</span>
<span class="gi">+ *</span>
<span class="gi">+ * \param     control        cbStyledTextCtrl*    The editor&#39;s wxStyledTextControl.</span>
<span class="gi">+ * \param     iLine          int                  The line on which was clicked.</span>
<span class="gi">+ * \param     iPos           int&amp;                 The current editor position.</span>
<span class="gi">+ * \param     sMidComment    wxString             The comment tag that starts each line in a block.</span>
<span class="gi">+ * \param     sTagParam      wxString             The doxygen tag for a parameter description.</span>
<span class="gi">+ * \param     sTagReturn     wxString             The doxygen tag for a return value description.</span>
<span class="gi">+ * \param     sIndent        wxString             A string of spaces matching the function&#39;s indent level.</span>
<span class="gi">+ * \return    void</span>
<span class="gi">+ *</span>
<span class="gi">+ */</span>
<span class="gi">+void DoxyBlocks::CommentFortran(cbStyledTextCtrl *control, int iLine, int &amp;iPos, wxString sMidComment, wxString sTagParam, wxString sTagReturn, wxString sIndent)</span>
<span class="gi">+{</span>
<span class="gi">+    wxString sSpace(wxT(&quot; &quot;));</span>
<span class="gi">+    wxString sLine = control-&gt;GetLine(iLine);</span>
<span class="gi">+    sLine = sLine.BeforeFirst(&#39;!&#39;); //cut comments</span>
<span class="gi">+    wxString sLineLw = sSpace+sLine.Lower().Trim(false);</span>
<span class="gi">+</span>
<span class="gi">+    if (sLineLw.Find(_T(&quot; function &quot;)) != wxNOT_FOUND ||</span>
<span class="gi">+        sLineLw.Find(_T(&quot; subroutine &quot;)) != wxNOT_FOUND)</span>
<span class="gi">+    {</span>
<span class="gi">+        while (sLine.Trim().EndsWith(_T(&quot;&amp;&quot;)))</span>
<span class="gi">+        {</span>
<span class="gi">+            iLine++;</span>
<span class="gi">+            wxString contLine = control-&gt;GetLine(iLine);</span>
<span class="gi">+            if (contLine.IsEmpty())</span>
<span class="gi">+                break;</span>
<span class="gi">+            sLine.Append(contLine.BeforeFirst(&#39;!&#39;).Trim().Trim(false));</span>
<span class="gi">+        }</span>
<span class="gi">+        sLine.Replace(_T(&quot;&amp;&amp;&quot;),wxEmptyString);</span>
<span class="gi">+</span>
<span class="gi">+        bool isFunction = false;</span>
<span class="gi">+        int idxW = sLineLw.Find(_T(&quot; function &quot;));</span>
<span class="gi">+        if (idxW == wxNOT_FOUND)</span>
<span class="gi">+            idxW = sLineLw.Find(_T(&quot; subroutine &quot;));</span>
<span class="gi">+        else</span>
<span class="gi">+            isFunction = true;</span>
<span class="gi">+        if (idxW == wxNOT_FOUND)</span>
<span class="gi">+            retu</span>
<em><strong>file truncated...</strong></em>
</pre></div>

      <h4 class="page-header">History</h4>
      
    </div>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.0/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>
  </body>
</html>

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Patch 1752 - Code::Blocks History</title>

    <!-- Bootstrap -->
    <link rel="stylesheet" href="https://netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap-theme.min.css">

    <link rel="stylesheet" href="../pygments.css">

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
      <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->
  </head>
  <body role="document">
    <div class="navbar navbar-inverse" role="navigation">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="http://www.codeblocks.org/">Code::Blocks</a>
        </div>
        <div class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
            <li><a href="../index.html">Home</a></li>
            <li><a href="../bugs.html">Bugs</a></li>
            <li><a href="../features.html">Features</a></li>
            <li class="active"><a href="../patches.html">Patches</a></li>
          </ul>
        </div>
      </div>
    </div>

    <div class="container" role="main">
      <div class="row">
        <div class="col-sm-8">
          <h3>Patch #1752 <small>2006-12-22 11:19</small></h3>
          <h4>dermeister</h4>
          Fix fur <a href="../bugs/9668.html" data-toggle="tooltip" title="&quot;File -&gt; Save As&quot; defaults to c/c++ filetype">Bug #9668</a>
          <dl class="dl-horizontal">
            <dt>Download</dt>
            <dd><a href="1752-Fix_fur_Bug_96.patch">1752-Fix_fur_Bug_96.patch</a> (1.8 KB)</dd>
          </dl>
        </div>
        <div class="col-sm-4">
          <dl class="dl-horizontal">
            <dt>Category</dt><dd>Application::Bugfix</dd>
            <dt>Status</dt><dd>Closed</dd>
            <dt>Close date</dt><dd>2006-12-24 11:18 <a href="http://cb.biplab.in/websvn/log.php?sr=3421"><span class="glyphicon glyphicon-link"></span></a></dd>
            <dt>Assigned to</dt><dd>&nbsp;</dd>
          </dl>
        </div>
      </div>
      <div class="highlight"><pre class="pre-scrollable"><span class="gh">Index: src/sdk/cbeditor.cpp</span>
<span class="gh">===================================================================</span>
<span class="gd">--- src/sdk/cbeditor.cpp        (revision 3412)</span>
<span class="gi">+++ src/sdk/cbeditor.cpp        (working copy)</span>
<span class="gu">@@ -1248,16 +1248,33 @@</span>
     int StoredIndex = 0;
     wxString Filters = FileFilters::GetFilterString();
     wxString Path = fname.GetPath();
<span class="gd">-    if(mgr)</span>
<span class="gi">+    wxString Extension = fname.GetExt();</span>
<span class="gi">+       wxString Filter;</span>
<span class="gi">+</span>
<span class="gi">+    if (!Extension.IsEmpty())</span>
     {
<span class="gd">-        wxString Filter = mgr-&gt;Read(_T(&quot;/file_dialogs/save_file_as/filter&quot;), _T(&quot;C/C++ files&quot;));</span>
<span class="gd">-        if(!Filter.IsEmpty())</span>
<span class="gd">-        {</span>
<span class="gd">-            FileFilters::GetFilterIndexFromName(Filters, Filter, StoredIndex);</span>
<span class="gd">-        }</span>
<span class="gd">-        if (Path.IsEmpty())</span>
<span class="gd">-            Path = mgr-&gt;Read(_T(&quot;/file_dialogs/save_file_as/directory&quot;), Path);</span>
<span class="gi">+       // Select filter belonging to this file type:</span>
<span class="gi">+       Extension.Prepend(_T(&quot;.&quot;));</span>
<span class="gi">+       Filter = FileFilters::GetFilterString(Extension);</span>
     }
<span class="gi">+    else if(mgr)</span>
<span class="gi">+    {</span>
<span class="gi">+       // File type is unknown. Select the last used filter:</span>
<span class="gi">+        Filter = mgr-&gt;Read(_T(&quot;/file_dialogs/save_file_as/filter&quot;), _T(&quot;C/C++ files&quot;));</span>
<span class="gi">+    }</span>
<span class="gi">+       if(!Filter.IsEmpty())</span>
<span class="gi">+       {</span>
<span class="gi">+               // We found a filter, look up its index:</span>
<span class="gi">+               int sep = Filter.find(_T(&quot;|&quot;));</span>
<span class="gi">+               if (sep != wxNOT_FOUND)</span>
<span class="gi">+                       Filter.Truncate(sep);</span>
<span class="gi">+               if (!Filter.IsEmpty())</span>
<span class="gi">+                       FileFilters::GetFilterIndexFromName(Filters, Filter, StoredIndex);</span>
<span class="gi">+       }</span>
<span class="gi">+</span>
<span class="gi">+    if ((mgr) &amp;&amp; (Path.IsEmpty()))</span>
<span class="gi">+               Path = mgr-&gt;Read(_T(&quot;/file_dialogs/save_file_as/directory&quot;), Path);</span>
<span class="gi">+</span>
     wxFileDialog* dlg = new wxFileDialog(Manager::Get()-&gt;GetAppWindow(),
                                          _(&quot;Save file&quot;),
                                          Path,
</pre></div>

      <h4 class="page-header">History</h4>
      <div class="panel panel-default">
        <div class="panel-heading">dermeister 2006-12-22 11:20</div>
        <div class="panel-body">
          <p>This patch fixes <a href="../bugs/9668.html" data-toggle="tooltip" title="&quot;File -&gt; Save As&quot; defaults to c/c++ filetype">bug #9668</a> ("File -&gt; Save As" defaults to c/c++ filetype).</p>
          <p>If the file that has to be saved already has an extension this extension will be used to look up the correct filter for this file. Otherwise the old method will be used.</p>
        </div>
      </div>
      <div class="panel panel-default">
        <div class="panel-heading">killerbot 2006-12-24 11:17</div>
        <div class="panel-body">
          <p>applied : rev 3421</p>
          <p>Thanks.</p>
        </div>
      </div>
      <div class="panel panel-default">
        <div class="panel-heading">killerbot 2006-12-24 11:18</div>
        <div class="panel-body">
          <p>fixed. rev 3421</p>
        </div>
      </div>
    </div>

    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
    <!-- Include all compiled plugins (below), or include individual files as needed -->
    <script src="https://netdna.bootstrapcdn.com/bootstrap/3.1.1/js/bootstrap.min.js"></script>
    <script>
      $(document).ready(function() {
        $("body").tooltip({ selector: '[data-toggle=tooltip]' });
      });
    </script>
  </body>
</html>
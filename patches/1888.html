<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Patch 1888 - Code::Blocks History</title>

    <!-- Bootstrap -->
    <link rel="stylesheet" href="https://netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap-theme.min.css">

    <link rel="stylesheet" href="../pygments.css">

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
      <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->
  </head>
  <body role="document">
    <div class="navbar navbar-inverse" role="navigation">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="http://www.codeblocks.org/">Code::Blocks</a>
        </div>
        <div class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
            <li><a href="../index.html">Home</a></li>
            <li><a href="../bugs.html">Bugs</a></li>
            <li><a href="../features.html">Features</a></li>
            <li class="active"><a href="../patches.html">Patches</a></li>
          </ul>
        </div>
      </div>
    </div>

    <div class="container" role="main">
      <div class="row">
        <div class="col-sm-8">
          <h3>Patch #1888 <small>2007-02-16 18:53:17</small></h3>
          <h4>dermeister</h4>
          [ <a href="../features/3129.html" data-toggle="tooltip" title="'clean' command line option">Feature Request #3129</a> ] 'clean' command line option
          <dl class="dl-horizontal">
            <dt>Download</dt>
            <dd><a href="1888-Feature_Reques.patch">1888-Feature_Reques.patch</a></dd>
          </dl>
        </div>
        <div class="col-sm-4">
          <dl class="dl-horizontal">
            <dt>Category</dt><dd>Application::FeatureAdd</dd>
            <dt>Status</dt><dd>Accepted</dd>
            <dt>Close date</dt><dd>2007-02-28 10:51:24 <a href="http://cb.biplab.in/websvn/log.php?sr=3652"><span class="glyphicon glyphicon-link"></span></a></dd>
            <dt>Assigned to</dt><dd>&nbsp;</dd>
          </dl>
        </div>
      </div>
      <div class="highlight"><pre class="pre-scrollable"><span class="gh">Index: src/src/app.h</span>
<span class="gh">===================================================================</span>
<span class="gd">--- src/src/app.h       (revision 3610)</span>
<span class="gi">+++ src/src/app.h       (working copy)</span>
<span class="gu">@@ -82,6 +82,7 @@</span>
         bool m_BatchWindowAutoClose; // default: true
         bool m_Build;
         bool m_ReBuild;
<span class="gi">+        bool m_Clean;</span>
         bool m_HasProject;
         bool m_HasWorkSpace;
         bool m_NoSplash; // no splash screen
<span class="gh">Index: src/src/app.cpp</span>
<span class="gh">===================================================================</span>
<span class="gd">--- src/src/app.cpp     (revision 3610)</span>
<span class="gi">+++ src/src/app.cpp     (working copy)</span>
<span class="gu">@@ -152,6 +152,7 @@</span>
     { wxCMD_LINE_OPTION, _T(&quot;&quot;), _T(&quot;profile&quot;),  _T(&quot;synonym to personality&quot;), wxCMD_LINE_VAL_STRING, wxCMD_LINE_NEEDS_SEPARATOR },
     { wxCMD_LINE_SWITCH, _T(&quot;&quot;), _T(&quot;rebuild&quot;), _T(&quot;clean and then build the project/workspace&quot;), wxCMD_LINE_VAL_NONE, wxCMD_LINE_PARAM_OPTIONAL },
     { wxCMD_LINE_SWITCH, _T(&quot;&quot;), _T(&quot;build&quot;), _T(&quot;just build the project/workspace&quot;), wxCMD_LINE_VAL_NONE, wxCMD_LINE_PARAM_OPTIONAL },
<span class="gi">+    { wxCMD_LINE_SWITCH, _T(&quot;&quot;), _T(&quot;clean&quot;), _T(&quot;clean the project/workspace&quot;), wxCMD_LINE_VAL_NONE, wxCMD_LINE_PARAM_OPTIONAL },</span>
     { wxCMD_LINE_OPTION, _T(&quot;&quot;), _T(&quot;target&quot;),  _T(&quot;the target for the batch build&quot;), wxCMD_LINE_VAL_STRING, wxCMD_LINE_NEEDS_SEPARATOR },
     { wxCMD_LINE_SWITCH, _T(&quot;&quot;), _T(&quot;no-batch-window-close&quot;),  _T(&quot;do not auto-close log window when batch build is done&quot;), wxCMD_LINE_VAL_NONE, wxCMD_LINE_PARAM_OPTIONAL },
     { wxCMD_LINE_SWITCH, _T(&quot;&quot;), _T(&quot;batch-build-notify&quot;),  _T(&quot;show message when batch build is done&quot;), wxCMD_LINE_VAL_NONE, wxCMD_LINE_PARAM_OPTIONAL },
<span class="gu">@@ -427,6 +428,7 @@</span>
     m_BatchNotify = false;
     m_Build = false;
     m_ReBuild = false;
<span class="gi">+    m_Clean = false;</span>
     m_HasProject = false;
     m_HasWorkSpace = false;
 
<span class="gu">@@ -582,10 +584,10 @@</span>
 #endif
     if (m_pSingleInstance)
         delete m_pSingleInstance;
<span class="gd">-       </span>
<span class="gi">+</span>
        // ultimate shutdown...
        Manager::Free();
<span class="gd">-    </span>
<span class="gi">+</span>
     // WX docs say that this function&#39;s return value is ignored,
     // but we return our value anyway. It might not be ignored at some point...
     return m_Batch ? m_BatchExitCode : 0;
<span class="gu">@@ -689,6 +691,17 @@</span>
                compiler-&gt;BuildWorkspace(m_BatchTarget);
        }
     }
<span class="gi">+    else if (m_Clean)</span>
<span class="gi">+    {</span>
<span class="gi">+       if(m_HasProject)</span>
<span class="gi">+       {</span>
<span class="gi">+               compiler-&gt;Clean(m_BatchTarget);</span>
<span class="gi">+       }</span>
<span class="gi">+       else if(m_HasWorkSpace)</span>
<span class="gi">+       {</span>
<span class="gi">+               compiler-&gt;CleanWorkspace(m_BatchTarget);</span>
<span class="gi">+       }</span>
<span class="gi">+    }</span>
 
     // the batch build log might have been deleted in
     // CodeBlocksApp::OnBatchBuildDone().
<span class="gu">@@ -833,7 +846,7 @@</span>
 
                     // batch jobs
                     m_Batch = m_HasProject || m_HasWorkSpace;
<span class="gd">-                    m_Batch = m_Batch &amp;&amp; (m_Build || m_ReBuild);</span>
<span class="gi">+                    m_Batch = m_Batch &amp;&amp; (m_Build || m_ReBuild || m_Clean);</span>
                 }
                 else
                 {
<span class="gu">@@ -857,10 +870,11 @@</span>
                     m_BatchWindowAutoClose = !parser.Found(_T(&quot;no-batch-window-close&quot;));
                     m_Build = parser.Found(_T(&quot;build&quot;));
                     m_ReBuild = parser.Found(_T(&quot;rebuild&quot;));
<span class="gi">+                    m_Clean = parser.Found(_T(&quot;clean&quot;));</span>
                     parser.Found(_T(&quot;target&quot;), &amp;m_BatchTarget);
                     parser.Found(_T(&quot;script&quot;), &amp;m_Script);
                     // initial setting for batch flag (will be reset when ParseCmdLine() is called again).
<span class="gd">-                    m_Batch = m_Build || m_ReBuild;</span>
<span class="gi">+                    m_Batch = m_Build || m_ReBuild || m_Clean;</span>
                 }
             }
             break;
</pre></div>

      <h4 class="page-header">History</h4>
      <div class="panel panel-default">
        <div class="panel-heading">dermeister 2007-02-16 18:56:53</div>
        <div class="panel-body">
          <p>This patch implements <a href="../features/3129.html" data-toggle="tooltip" title="'clean' command line option">feature request #3129</a> ('clean' command line option).</p>
          <p>Drawback:</p>
          <p>The batch-build window is not closed after cleaning the target has finished. This is because the compiler plugin generates no EVT_COMPILER_FINISHED event when it is called for cleaning the project. I'm not quite sure about how to solve that.</p>
        </div>
      </div>
    </div>

    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
    <!-- Include all compiled plugins (below), or include individual files as needed -->
    <script src="https://netdna.bootstrapcdn.com/bootstrap/3.1.1/js/bootstrap.min.js"></script>
    <script>
      $(document).ready(function() {
        $("body").tooltip({ selector: '[data-toggle=tooltip]' });
      });
    </script>
  </body>
</html>
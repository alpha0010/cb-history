<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Patch 948 - Code::Blocks History</title>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap-theme.min.css">
    <link rel="stylesheet" href="../pygments.css">
  </head>
  <body role="document">
    <div class="navbar navbar-inverse" role="navigation">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="http://www.codeblocks.org/">Code::Blocks</a>
        </div>
        <div class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
            <li><a href="../index.html">Home</a></li>
            <li><a href="../bugs.html">Bugs</a></li>
            <li><a href="../features.html">Features</a></li>
            <li class="active"><a href="../patches.html">Patches</a></li>
          </ul>
        </div>
      </div>
    </div>

    <div class="container" role="main">
      <div class="row">
        <div class="col-sm-8">
          <h3>Patch #948 <small>2006-03-22 23:42</small></h3>
          <h4>olorin</h4>
          toolbars of compiler &amp; debugger plugins + debugger plugin fo
          <dl class="dl-horizontal">
            <dt>Download</dt>
            <dd><a href="948-toolbars_of_com.patch">948-toolbars_of_com.patch</a> (5.0 KB)</dd>
          </dl>
        </div>
        <div class="col-sm-4">
          <dl class="dl-horizontal">
            <dt>Category</dt><dd>Plugin::Refinement</dd>
            <dt>Status</dt><dd>Out of date</dd>
            <dt>Close date</dt><dd>2007-04-12 11:29</dd>
            <dt>Assigned to</dt><dd>&nbsp;</dd>
          </dl>
        </div>
      </div>
      <div class="highlight"><pre class="pre-scrollable"><span class="gh">Index: compilergcc/compilergcc.cpp</span>
<span class="gh">===================================================================</span>
<span class="gd">--- compilergcc/compilergcc.cpp    (revision 2228)</span>
<span class="gi">+++ compilergcc/compilergcc.cpp    (working copy)</span>
<span class="gu">@@ -182,7 +182,6 @@</span>
     m_ListPageIndex(-1),
     m_Menu(0L),
     m_TargetMenu(0L),
<span class="gd">-    m_pToolbar(0L),</span>
     m_TargetIndex(-1),
     m_ErrorsMenu(0L),
     m_Project(0L),
<span class="gu">@@ -442,22 +441,6 @@</span>
 //        delete m_Menu;
 //        m_Menu = 0L;
 //    }
<span class="gd">-</span>
<span class="gd">-    if (m_pToolbar)</span>
<span class="gd">-    {</span>
<span class="gd">-        m_pToolbar-&gt;DeleteTool(idMenuCompile);</span>
<span class="gd">-        m_pToolbar-&gt;DeleteTool(idMenuRun);</span>
<span class="gd">-        m_pToolbar-&gt;DeleteTool(idMenuCompileAndRun);</span>
<span class="gd">-        m_pToolbar-&gt;DeleteTool(idMenuRebuild);</span>
<span class="gd">-</span>
<span class="gd">-        m_pToolbar-&gt;DeleteTool(idToolTarget);</span>
<span class="gd">-        delete m_ToolTarget;</span>
<span class="gd">-        m_ToolTarget = 0L;</span>
<span class="gd">-</span>
<span class="gd">-        m_pToolbar-&gt;DeleteTool(idToolTargetLabel);</span>
<span class="gd">-        delete m_ToolTargetLabel;</span>
<span class="gd">-        m_ToolTargetLabel = 0L;</span>
<span class="gd">-    }</span>
 }
 
 int CompilerGCC::Configure(cbProject* project, ProjectBuildTarget* target)
<span class="gu">@@ -2692,16 +2675,16 @@</span>
     }
 
     // enable/disable compiler toolbar buttons
<span class="gd">-    wxToolBar* tbar = m_pTbar;//Manager::Get()-&gt;GetAppWindow()-&gt;GetToolBar();</span>
<span class="gd">-    if (tbar)</span>
<span class="gi">+    //wxToolBar* tbar = m_pTbar;//Manager::Get()-&gt;GetAppWindow()-&gt;GetToolBar();</span>
<span class="gi">+    if (m_pTbar)</span>
     {
<span class="gd">-        tbar-&gt;EnableTool(idMenuCompile, !running &amp;&amp; (prj || ed));</span>
<span class="gd">-        tbar-&gt;EnableTool(idMenuRun, !running &amp;&amp; (prj || ed));</span>
<span class="gd">-        tbar-&gt;EnableTool(idMenuCompileAndRun, !running &amp;&amp; (prj || ed));</span>
<span class="gd">-        tbar-&gt;EnableTool(idMenuRebuild, !running &amp;&amp; (prj || ed));</span>
<span class="gd">-        tbar-&gt;EnableTool(idMenuKillProcess, running &amp;&amp; prj);</span>
<span class="gi">+        m_pTbar-&gt;EnableTool(idMenuCompile, !running &amp;&amp; (prj || ed));</span>
<span class="gi">+        m_pTbar-&gt;EnableTool(idMenuRun, !running &amp;&amp; (prj || ed));</span>
<span class="gi">+        m_pTbar-&gt;EnableTool(idMenuCompileAndRun, !running &amp;&amp; (prj || ed));</span>
<span class="gi">+        m_pTbar-&gt;EnableTool(idMenuRebuild, !running &amp;&amp; (prj || ed));</span>
<span class="gi">+        m_pTbar-&gt;EnableTool(idMenuKillProcess, running &amp;&amp; prj);</span>
 
<span class="gd">-        m_ToolTarget = XRCCTRL(*tbar, &quot;idToolTarget&quot;, wxComboBox);</span>
<span class="gi">+        m_ToolTarget = XRCCTRL(*m_pTbar, &quot;idToolTarget&quot;, wxComboBox);</span>
         if (m_ToolTarget)
             m_ToolTarget-&gt;Enable(!running &amp;&amp; prj);
     }
<span class="gh">Index: compilergcc/compilergcc.h</span>
<span class="gh">===================================================================</span>
<span class="gd">--- compilergcc/compilergcc.h    (revision 2228)</span>
<span class="gi">+++ compilergcc/compilergcc.h    (working copy)</span>
<span class="gu">@@ -186,7 +186,6 @@</span>
         int m_ListPageIndex;
         wxMenu* m_Menu;
         wxMenu* m_TargetMenu;
<span class="gd">-        wxToolBar* m_pToolbar;</span>
         int m_TargetIndex;
         wxMenu* m_ErrorsMenu;
         cbProject* m_Project;
<span class="gh">Index: debuggergdb/debuggergdb.cpp</span>
<span class="gh">===================================================================</span>
<span class="gd">--- debuggergdb/debuggergdb.cpp    (revision 2228)</span>
<span class="gi">+++ debuggergdb/debuggergdb.cpp    (working copy)</span>
<span class="gu">@@ -498,11 +498,12 @@</span>
 
 bool DebuggerGDB::BuildToolBar(wxToolBar* toolBar)
 {
<span class="gd">-    m_pTbar = toolBar;</span>
<span class="gd">-    /* Loads toolbar using new Manager class functions */</span>
 #ifdef implement_debugger_toolbar
     if (!m_IsAttached || !toolBar)
         return false;
<span class="gi">+</span>
<span class="gi">+    m_pTbar = toolBar;</span>
<span class="gi">+    /* Loads toolbar using new Manager class functions */</span>
     wxString my_16x16=Manager::isToolBar16x16(toolBar) ? _T(&quot;_16x16&quot;) : _T(&quot;&quot;);
     Manager::AddonToolBar(toolBar,wxString(_T(&quot;debugger_toolbar&quot;))+my_16x16);
     toolBar-&gt;Realize();
<span class="gu">@@ -1449,15 +1450,18 @@</span>
     }
 
     #ifdef implement_debugger_toolbar
<span class="gd">-    wxToolBar* tbar = m_pTbar;//Manager::Get()-&gt;GetAppWindow()-&gt;GetToolBar();</span>
<span class="gd">-    tbar-&gt;EnableTool(idMenuDebug, (!m_pProcess || stopped) &amp;&amp; en);</span>
<span class="gd">-    tbar-&gt;EnableTool(idMenuRunToCursor, en &amp;&amp; ed &amp;&amp; stopped);</span>
<span class="gd">-    tbar-&gt;EnableTool(idMenuNext, m_pProcess &amp;&amp; en &amp;&amp; stopped);</span>
<span class="gd">-    tbar-&gt;EnableTool(idMenuNextInstr, m_pProcess &amp;&amp; en &amp;&amp; stopped);</span>
<span class="gd">-    tbar-&gt;EnableTool(idMenuStep, en &amp;&amp; stopped);</span>
<span class="gd">-    tbar-&gt;EnableTool(idMenuStepOut, m_pProcess &amp;&amp; en &amp;&amp; stopped);</span>
<span class="gd">-    tbar-&gt;EnableTool(idMenuStop, m_pProcess &amp;&amp; en);</span>
<span class="gd">-    tbar-&gt;EnableTool(idDebuggerToolInfo, m_pProcess &amp;&amp; en);</span>
<span class="gi">+    if (m_pTbar)</span>
<span class="gi">+    {</span>
<span class="gi">+        //wxToolBar* tbar = m_pTbar;//Manager::Get()-&gt;GetAppWindow()-&gt;GetToolBar();</span>
<span class="gi">+        m_pTbar-&gt;EnableTool(idMenuDebug, (!m_pProcess || stopped) &amp;&amp; en);</span>
<span class="gi">+        m_pTbar-&gt;EnableTool(idMenuRunToCursor, en &amp;&amp; ed &amp;&amp; stopped);</span>
<span class="gi">+        m_pTbar-&gt;EnableTool(idMenuNext, m_pProcess &amp;&amp; en &amp;&amp; stopped);</span>
<span class="gi">+        m_pTbar-&gt;EnableTool(idMenuNextInstr, m_pProcess &amp;&amp; en &amp;&amp; stopped);</span>
<span class="gi">+        m_pTbar-&gt;EnableTool(idMenuStep, en &amp;&amp; stopped);</span>
<span class="gi">+        m_pTbar-&gt;EnableTool(idMenuStepOut, m_pProcess &amp;&amp; en &amp;&amp; stopped);</span>
<span class="gi">+        m_pTbar-&gt;EnableTool(idMenuStop, m_pProcess &amp;&amp; en);</span>
<span class="gi">+        m_pTbar-&gt;EnableTool(idDebuggerToolInfo, m_pProcess &amp;&amp; en);</span>
<span class="gi">+    }</span>
     #endif
 
     // allow other UpdateUI handlers to process this event
<span class="gh">Index: debuggergdb/examinememorydlg.cpp</span>
<span class="gh">===================================================================</span>
<span class="gd">--- debuggergdb/examinememorydlg.cpp    (revision 2228)</span>
<span class="gi">+++ debuggergdb/examinememorydlg.cpp    (working copy)</span>
<span class="gu">@@ -90,7 +90,7 @@</span>
             m_pText-&gt;AppendText(
<em><strong>download for full patch...</strong></em>
</pre></div>

      <h4 class="page-header">History</h4>
      <div class="panel panel-default">
        <div class="panel-heading">mandrav 2006-03-23 19:07</div>
        <div class="panel-body">
          <p>Could you explain what this patch does please?</p>
        </div>
      </div>
      <div class="panel panel-default">
        <div class="panel-heading">olorin 2006-03-23 21:29</div>
        <div class="panel-body">
          <p>1st of all, and silly me: there's an error in the patch, I've upload a revised one. Sorry for the inconvenience...</p>
          <p>1) compiler plugin: remove the unused m_pToolbar (there's m_pTbar in use)</p>
          <p>2) compiler &amp; debugger plugins: use m_pTbar instead of a temprary in OnUpdateUI</p>
          <p>3) debbuger plugin: check m_pTbar before accessing it, in OnUpdateUI again</p>
          <p>4) debbuger plugin: fix a printf argument in examinememorydlg.cpp</p>
          <p>Maybe too much things for the same patch... the first 3 are similar/related, the last is quite safe althought unrelated. Should I have posted 3 differente patches?</p>
          <p>Finally, since this was my first time with BerliOS (but I've contributed a few patched from sourceforge, as olorin_): I wondered where I should have put a description, but I just saw a "OR Paste the patch here, instead of uploading it:"... so:</p>
          <p>1) Should that form contain the description, too? Or</p>
          <p>2) Should the two (uploading the patch and adding a description) be made as two different steps?</p>
          <p>I guess there's documentation about it, but if you feel you can give a short answer I'd appreciate it.</p>
          <p>Sorry again for the wrong patch.</p>
        </div>
      </div>
      <div class="panel panel-default">
        <div class="panel-heading">olorin 2006-03-23 21:40</div>
        <div class="panel-body">
          <p>Another note: in DebuggerGDB::BuildToolBar I'm not so sure that bringing</p>
          <p>m_pTbar = toolBar;</p>
          <p>inside the if is safe/correct. I thought it was, but please take my doubts into account.</p>
        </div>
      </div>
    </div>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.0/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>
  </body>
</html>

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Patch 1559 - Code::Blocks History</title>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap-theme.min.css">
  </head>
  <body role="document">
    <div class="navbar navbar-inverse" role="navigation">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="http://www.codeblocks.org/">Code::Blocks</a>
        </div>
        <div class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
            <li><a href="../index.html">Home</a></li>
            <li><a href="../bugs.html">Bugs</a></li>
            <li><a href="../features.html">Features</a></li>
            <li class="active"><a href="../patches.html">Patches</a></li>
          </ul>
        </div>
      </div>
    </div>

    <div class="container" role="main">
      <div class="row">
        <div class="col-sm-8">
          <h3>Patch #1559 <small>2006-10-14 11:13</small></h3>
          <h4>swjinjin</h4>
          ClassBrowser::UpdateView's bug fix
          <dl class="dl-horizontal">
            <dt>Download</dt>
            <dd><a href="1559-ClassBrowser_U.patch">1559-ClassBrowser_U.patch</a> (1.7 KB)</dd>
          </dl>
        </div>
        <div class="col-sm-4">
          <dl class="dl-horizontal">
            <dt>Category</dt><dd>Plugin::Bugfix</dd>
            <dt>Status</dt><dd>Accepted</dd>
            <dt>Close date</dt><dd>2007-04-12 11:27 <a href="http://cb.biplab.in/websvn/log.php?sr=3845"><span class="glyphicon glyphicon-link"></span></a></dd>
            <dt>Assigned to</dt><dd>mandrav</dd>
          </dl>
        </div>
      </div>
      <div class="highlight"><pre class="pre-scrollable">Hellow.
Thank you very much for nice tool.

ClassBrowser::UpdateView&#39;s bug is the following.

void ClassBrowser::UpdateView()
{
    m_pActiveProject = 0;
    m_ActiveFilename.Clear();
    if (m_pParser &amp;&amp; !Manager::isappShuttingDown())
   {
        m_pActiveProject = Manager::Get()-&gt;GetProjectManager()-&gt;GetActiveProject();
        cbEditor* ed = Manager::Get()-&gt;GetEditorManager()-&gt;GetBuiltinActiveEditor();
        if (ed)
        {
// This line is the cause of bug.
            m_ActiveFilename = ed-&gt;GetFilename().BeforeLast(_T(&#39;.&#39;));
            m_ActiveFilename.Append(_T(&#39;.&#39;));
        }
        BuildTree();
    }
    else
        m_Tree-&gt;DeleteAllItems();
}

If the file name is C:\Work\new\SIP\wifi\Phonex-wifi-3.1\OnePhone\pub\Makefile, the m_ActiveFilename becomes C:\Work\new\SIP\wifi\Phonex-wifi-3.
This make the all files reparsed, and this cause the Code::Blocks to stop any operation.

So, i made some fix as the following.

void ClassBrowser::UpdateView()
{
    m_pActiveProject = 0;
    m_ActiveFilename.Clear();
    if (m_pParser &amp;&amp; !Manager::isappShuttingDown())
   {
        m_pActiveProject = Manager::Get()-&gt;GetProjectManager()-&gt;GetActiveProject();
        cbEditor* ed = Manager::Get()-&gt;GetEditorManager()-&gt;GetBuiltinActiveEditor();
        if (ed)
        {
// This line is the cause of bug.
            //m_ActiveFilename = ed-&gt;GetFilename().BeforeLast(_T(&#39;.&#39;));

            m_ActiveFilename = ed-&gt;GetFilename().AfterLast(_T(&#39;\\&#39;));
            m_ActiveFilename = ed-&gt;GetFilename().BeforeLast(_T(&#39;\\&#39;)) + _T(&#39;\\&#39;) + m_ActiveFilename.BeforeLast(_T(&#39;.&#39;));
            
            m_ActiveFilename.Append(_T(&#39;.&#39;));
        }
        BuildTree();
    }
    else
        m_Tree-&gt;DeleteAllItems();
}

Best regards
Sangwoo Jin
</pre></div>

      <h4 class="page-header">History</h4>
      <div class="panel panel-default">
        <div class="panel-heading">killerbot 2006-10-26 21:14</div>
        <div class="panel-body">
          <p>one thing from a quick look at the patch, we will make it work on the separator of the platform, since on linux we will have / instead of \</p>
        </div>
      </div>
      <div class="panel panel-default">
        <div class="panel-heading">mandrav 2007-04-12 11:27</div>
        <div class="panel-body">
          <p>Patch applied, thank you.</p>
        </div>
      </div>
    </div>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.0/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>
  </body>
</html>
